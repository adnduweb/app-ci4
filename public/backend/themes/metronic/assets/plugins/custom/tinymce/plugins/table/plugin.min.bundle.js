(()=>{function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}!function(){"use strict";function n(n){return function(t){return o=e(r=t),(null===r?"null":"object"==o&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":o)===n;var r,o}}function t(n){return function(t){return e(t)===n}}function r(e){return function(n){return e===n}}function o(e){return!(null==e)}function u(){}function i(e){return function(){return e}}function c(e){return e}function l(e,n){return e===n}var a=n("string"),f=n("object"),s=n("array"),m=r(null),d=t("boolean"),g=r(void 0),p=t("function"),b=t("number");function h(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.concat(t);return e.apply(null,o)}}function v(e){return function(n){return!e(n)}}function w(){return S}var y=i(!1),C=i(!0),S={fold:function(e,n){return e()},isSome:y,isNone:C,getOr:c,getOrThunk:T,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:c,orThunk:T,map:w,each:u,bind:w,exists:y,forall:C,filter:function(){return S},toArray:function(){return[]},toString:i("none()")};function T(e){return e()}function x(e,n){return-1<$.call(e,n)}function R(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return!0;return!1}function D(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t}function O(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var u=e[o];r[o]=n(u,o)}return r}function A(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)}function k(e,n){for(var t=[],r=[],o=0,u=e.length;o<u;o++){var i=e[o];(n(i,o)?t:r).push(i)}return{pass:t,fail:r}}function I(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var u=e[r];n(u,r)&&t.push(u)}return t}function B(e,n,t){return function(e){for(var r,o=e.length-1;0<=o;o--)r=e[o],t=n(t,r,o)}(e),t}function M(e,n,t){return A(e,(function(e,r){t=n(t,e,r)})),t}function E(e,n){return function(e,n,t){for(var r=0,o=e.length;r<o;r++){var u=e[r];if(n(u,r))return U.some(u);if(t(u,r))break}return U.none()}(e,n,y)}function P(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return U.some(t);return U.none()}function N(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!s(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);K.apply(n,e[t])}return n}function z(e,n){return N(O(e,n))}function L(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t))return!1;return!0}function _(e,n){for(var t={},r=0,o=e.length;r<o;r++){var u=e[r];t[String(u)]=n(u,r)}return t}function W(e){return[e]}function j(e,n){return 0<=n&&n<e.length?U.some(e[n]):U.none()}function F(e){return j(e,0)}function H(e){return j(e,e.length-1)}function V(e,n){for(var t=0;t<e.length;t++){var r=n(e[t],t);if(r.isSome())return r}return U.none()}var q=function e(n){function t(){return u}function r(e){return e(n)}var o=i(n),u={fold:function(e,t){return t(n)},isSome:C,isNone:y,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return e(t(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?u:S},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return u},U={some:q,none:w,from:function(e){return null==e?S:q(e)}},G=Array.prototype.slice,$=Array.prototype.indexOf,K=Array.prototype.push,X=function(){return(X=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function Y(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||((r=r||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}function J(e){var n,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,n=e.apply(null,r)),n}}function Q(e,n){var t=String(n).toLowerCase();return E(e,(function(e){return e.search(t)}))}function Z(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function ee(e,n){return-1!==e.indexOf(n)}function ne(e,n){return Z(e,n,e.length-n.length)}function te(e){return 0<e.length}function re(e){return function(n){return ee(n,e)}}function oe(e){return window.matchMedia(e).matches}function ue(e,n){var t=e.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function ie(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function ce(e,n){var t=void 0===n?document:n.dom;return ie(t)?U.none():U.from(t.querySelector(e)).map(qe.fromDom)}function le(e,n){return e.dom===n.dom}function ae(e,n){return Ve().browser.isIE()?(t=e.dom,r=n.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(r)&o)):(u=e.dom)!==(i=n.dom)&&u.contains(i);var t,r,o,u,i}function fe(e,n){for(var t=Ge(e),r=0,o=t.length;r<o;r++){var u=t[r];n(e[u],u)}}function se(e,n){return Ke(e,(function(e,t){return{k:t,v:n(e,t)}}))}function me(e,n){var t={},r=n,o=t,i=function(e,n){o[n]=e},c=u;return fe(e,(function(e,n){(r(e,n)?i:c)(e,n)})),t}function de(e,n){var t=[];return fe(e,(function(e,r){t.push(n(e,r))})),t}function ge(e){return de(e,c)}function pe(e){return Ge(e).length}function be(e,n){return Xe(e,n)?U.from(e[n]):U.none()}function he(e,n){return Xe(e,n)&&void 0!==e[n]&&null!==e[n]}function ve(e,n,t){return{element:e,rowspan:n,colspan:t}}function we(e,n,t){return{element:e,cells:n,section:t}}function ye(e,n,t){return{element:e,isNew:n,isLocked:t}}function Ce(e,n,t,r){return{element:e,cells:n,section:t,isNew:r}}function Se(){return Oe(0,0)}function Te(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Ee),isSafari:n("Safari")}}function xe(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isWindows:n(ze),isiOS:n("iOS"),isAndroid:n(Le),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(_e),isFreeBSD:n(We),isChromeOS:n(je)}}function Re(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}var De,Oe=function(e,n){return{major:e,minor:n}},Ae={nu:Oe,detect:function(e,n){var t,r,o=String(n).toLowerCase();return 0===e.length?Se():(r=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,t=o))?Oe(u(1),u(2)):{major:0,minor:0};function u(e){return Number(t.replace(r,"$"+e))}},unknown:Se},ke=function(e,n){return Z(e,n,0)},Ie=(De=/^\s+|\s+$/g,function(e){return e.replace(De,"")}),Be=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Me={browsers:i([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return ee(e,"edge/")&&ee(e,"chrome")&&ee(e,"safari")&&ee(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Be],search:function(e){return ee(e,"chrome")&&!ee(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return ee(e,"msie")||ee(e,"trident")}},{name:"Opera",versionRegexes:[Be,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:re("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:re("firefox")},{name:"Safari",versionRegexes:[Be,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(ee(e,"safari")||ee(e,"mobile/"))&&ee(e,"applewebkit")}}]),oses:i([{name:"Windows",search:re("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return ee(e,"iphone")||ee(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:re("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:re("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:re("linux"),versionRegexes:[]},{name:"Solaris",search:re("sunos"),versionRegexes:[]},{name:"FreeBSD",search:re("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:re("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Ee="Firefox",Pe=function(){return Te({current:void 0,version:Ae.unknown()})},Ne=Te,ze=(i("Edge"),i("Chrome"),i("IE"),i("Opera"),i(Ee),i("Safari"),"Windows"),Le="Android",_e="Solaris",We="FreeBSD",je="ChromeOS",Fe=function(){return xe({current:void 0,version:Ae.unknown()})},He=xe,Ve=(i(ze),i("iOS"),i(Le),i("Linux"),i("OSX"),i(_e),i(We),i(je),J((function(){return e=navigator.userAgent,n=U.from(navigator.userAgentData),t=oe,b=Me.browsers(),h=Me.oses(),v=n.bind((function(e){return n=b,V(e.brands,(function(e){var t=e.brand.toLowerCase();return E(n,(function(e){var n;return t===(null===(n=e.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(n){return{current:n.name,version:Ae.nu(parseInt(e.version,10),0)}}))}));var n})).orThunk((function(){return Q(b,n=e).map((function(e){var t=Ae.detect(e.versionRegexes,n);return{current:e.name,version:t}}));var n})).fold(Pe,Ne),w=Q(h,r=e).map((function(e){var n=Ae.detect(e.versionRegexes,r);return{current:e.name,version:n}})).fold(Fe,He),{browser:v,os:w,deviceType:(u=v,c=e,l=t,a=(o=w).isiOS()&&!0===/ipad/i.test(c),f=o.isiOS()&&!a,m=(s=o.isiOS()||o.isAndroid())||l("(pointer:coarse)"),d=a||!f&&s&&l("(min-device-width:768px)"),g=f||s&&!d,p=u.isSafari()&&o.isiOS()&&!1===/safari/i.test(c),{isiPad:i(a),isiPhone:i(f),isTablet:i(d),isPhone:i(g),isTouch:i(m),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:i(p),isDesktop:i(!g&&!d&&!p)})};var e,n,t,r,o,u,c,l,a,f,s,m,d,g,p,b,h,v,w}))),qe={fromHtml:function(e,n){var t=(n||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Re(t.childNodes[0])},fromTag:function(e,n){return Re((n||document).createElement(e))},fromText:function(e,n){return Re((n||document).createTextNode(e))},fromDom:Re,fromPoint:function(e,n,t){return U.from(e.dom.elementFromPoint(n,t)).map(Re)}},Ue=ue,Ge=Object.keys,$e=Object.hasOwnProperty,Ke=function(e,n){var t={};return fe(e,(function(e,r){var o=n(e,r);t[o.k]=o.v})),t},Xe=function(e,n){return $e.call(e,n)},Ye=["tfoot","thead","tbody","colgroup"];function Je(e){return e.dom.nodeName.toLowerCase()}function Qe(e){return e.dom.nodeType}function Ze(e){return function(n){return Qe(n)===e}}function en(e){return 8===Qe(e)||"#comment"===Je(e)}function nn(e){return function(n){return pn(n)&&Je(n)===e}}function tn(e){return qe.fromDom(e.dom.ownerDocument)}function rn(e){return hn(e)?e:tn(e)}function on(e){return U.from(e.dom.parentNode).map(qe.fromDom)}function un(e,n){for(var t=p(n)?n:y,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=qe.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function cn(e){return U.from(e.dom.previousSibling).map(qe.fromDom)}function ln(e){return U.from(e.dom.nextSibling).map(qe.fromDom)}function an(e){return O(e.dom.childNodes,qe.fromDom)}function fn(e,n){var t=e.dom.childNodes;return U.from(t[n]).map(qe.fromDom)}function sn(e){return qe.fromDom(e.dom.host)}function mn(e,n,t){return r=function(e){return ue(e,n)},I(un(e,t),r);var r}function dn(e,n){return t=function(e){return ue(e,n)},I(an(e),t);var t}function gn(e,n){return ie(t=void 0===e?document:e.dom)?[]:O(t.querySelectorAll(n),qe.fromDom);var t}"undefined"!=typeof window||Function("return this;")();var pn=Ze(1),bn=Ze(3),hn=Ze(9),vn=Ze(11),wn=p(Element.prototype.attachShadow)&&p(Node.prototype.getRootNode),yn=i(wn),Cn=wn?function(e){return qe.fromDom(e.dom.getRootNode())}:rn,Sn=function e(n){var t=bn(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var r,u,i,c,l,a=t.ownerDocument;return i=qe.fromDom(t),l=Cn(i),(vn(c=l)&&o(c.dom.host)?U.some(l):U.none()).fold((function(){return a.body.contains(t)}),(r=e,u=sn,function(e){return r(u(e))}))},Tn=function(e){var n=e.dom.body;if(null==n)throw new Error("Body is not available yet");return qe.fromDom(n)},xn=function e(n,t){var r=[];return A(an(n),(function(n){r=(r=t(n)?r.concat([n]):r).concat(e(n,t))})),r};function Rn(e,n,t,r,o){return e(t,r)?U.some(t):p(o)&&o(t)?U.none():n(t,r,o)}function Dn(e,n,t){for(var r=e.dom,o=p(t)?t:y;r.parentNode;){r=r.parentNode;var u=qe.fromDom(r);if(n(u))return U.some(u);if(o(u))break}return U.none()}function On(e,n,t){return Dn(e,(function(e){return ue(e,n)}),t)}function An(e,n){return t=function(e){return ue(e,n)},E(e.dom.childNodes,(function(e){return t(qe.fromDom(e))})).map(qe.fromDom);var t}function kn(e,n){return ce(n,e)}function In(e,n,t){return Rn(ue,On,e,n,t)}function Bn(e,n,t){if(!(a(t)||d(t)||b(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Mn(e,n,t){Bn(e.dom,n,t)}function En(e,n){var t=e.dom;fe(n,(function(e,n){Bn(t,n,e)}))}function Pn(e,n){var t=e.dom.getAttribute(n);return null===t?void 0:t}function Nn(e,n){return U.from(Pn(e,n))}function zn(e){return M(e.dom.attributes,(function(e,n){return e[n.name]=n.value,e}),{})}function Ln(e,n,t){return void 0===t&&(t=l),e.exists((function(e){return t(e,n)}))}function _n(e){for(var n=[],t=function(e){n.push(e)},r=0;r<e.length;r++)e[r].each(t);return n}function Wn(e,n,t){return e.isSome()&&n.isSome()?U.some(t(e.getOrDie(),n.getOrDie())):U.none()}function jn(e,n){return e?U.some(n):U.none()}function Fn(e){return void 0!==e.style&&p(e.style.getPropertyValue)}function Hn(e,n,t){if(!a(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);Fn(e)&&e.style.setProperty(n,t)}function Vn(e,n,t){Hn(e.dom,n,t)}function qn(e,n){var t=e.dom;fe(n,(function(e,n){Hn(t,n,e)}))}function Un(e,n){var t=e.dom,r=window.getComputedStyle(t).getPropertyValue(n);return""!==r||Sn(e)?r:jt(t,n)}function Gn(e,n){var t=e.dom,r=jt(t,n);return U.from(r).filter((function(e){return 0<e.length}))}function $n(e,n){var t,r=n;Fn(t=e.dom)&&t.style.removeProperty(r),Ln(Nn(e,"style").map(Ie),"")&&Wt(e,"style")}function Kn(e,n,t){return void 0===t&&(t=0),Nn(e,n).map((function(e){return parseInt(e,10)})).getOr(t)}function Xn(e,n){return Kn(e,n,1)}function Yn(e){return nn("col")(e)?1<Kn(e,"span",1):1<Xn(e,"colspan")}function Jn(e){return 1<Xn(e,"rowspan")}function Qn(e,n){return parseInt(Un(e,n),10)}function Zn(e,n){return Vt(e,n,C)}function et(e,n){return t=["td","th"],(o=void 0===(o=n)?y:n)(r=e)?U.none():x(t,Je(r))?U.some(r):On(r,t.join(","),(function(e){return ue(e,"table")||o(e)}));var t,r,o}function nt(e){return Zn(e,"th,td")}function tt(e){return ue(e,"colgroup")?dn(e,"col"):z(qt(e),(function(e){return dn(e,"col")}))}function rt(e,n){return In(e,"table",n)}function ot(e){return Zn(e,"tr")}function ut(e,n){return O(e,(function(e){if("colgroup"!==Je(e))return we(e,t=O(nt(e),(function(e){return ve(e,Kn(e,"rowspan",1),Kn(e,"colspan",1))})),n(e));var t=O(tt(e),(function(e){return ve(e,1,Kn(e,"span",1))}));return we(e,t,"colgroup")}))}function it(e){return on(e).map((function(e){var n=Je(e);return x(Ye,n)?n:"tbody"})).getOr("tbody")}function ct(e){var n=ot(e);return ut(Y(Y([],qt(e),!0),n,!0),it)}function lt(e,n,t){var r=e.cells,o=r.slice(0,n),u=r.slice(n),i=o.concat(t).concat(u);return Ut(e,i)}function at(e,n,t){return lt(e,n,[t])}function ft(e,n,t){e.cells[n]=t}function st(e,n){return e.cells[n]}function mt(e,n){return st(e,n).element}function dt(e){return e.cells.length}function gt(e){var n=k(e,(function(e){return"colgroup"===e.section}));return{rows:n.fail,cols:n.pass}}function pt(e,n,t){var r=O(e.cells,t);return Ce(n(e.element),r,e.section,!0)}function bt(e){return Nn(e,Gt).bind((function(e){return U.from(e.match(/\d+/g))})).map((function(e){return _(e,C)}))}function ht(e){var n,t=de(M(gt(e).rows,(function(e,n){return A(n.cells,(function(n,t){n.isLocked&&(e[t]=!0)})),e}),{}),(function(e,n){return parseInt(n,10)}));return(n=G.call(t,0)).sort(void 0),n}function vt(e){var n={},t=[],r=F(e).map((function(e){return e.element})).bind(rt).bind(bt).getOr({}),o=0,u=0,i=0,c=k(e,(function(e){return"colgroup"===e.section})),l=c.pass;A(c.fail,(function(e){var c=[];A(e.cells,(function(e){for(var t=0;void 0!==n[i+","+t];)t++;for(var o=he(r,t.toString()),l={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:i,column:t,isLocked:o},a=0;a<e.colspan;a++)for(var f=0;f<e.rowspan;f++){var s=t+a;n[i+f+","+s]=l,u=Math.max(u,s+1)}c.push(l)})),o++,t.push(we(e.element,c,e.section)),i++}));var a=H(l).map((function(e){var n,t,r=(n={},t=0,A(e.cells,(function(e){var r=e.colspan;D(r,(function(o){var u=t+o;n[u]={element:e.element,colspan:r,column:u}})),t+=r})),n);return{colgroups:[{element:e.element,columns:ge(r)}],columns:r}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),f=a.columns,s=a.colgroups;return{grid:{rows:o,columns:u},access:n,all:t,columns:f,colgroups:s}}function wt(e,n){var t=n.column,r=n.column+n.colspan-1,o=n.row,u=n.row+n.rowspan-1;return t<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&u>=e.startRow}function yt(e,n){return n.column>=e.startCol&&n.column+n.colspan-1<=e.finishCol&&n.row>=e.startRow&&n.row+n.rowspan-1<=e.finishRow}function Ct(e,n,t){var r=$t.findItem(e,n,le),o=$t.findItem(e,t,le);return r.bind((function(e){return o.map((function(n){return t=e,r=n,{startRow:Math.min(t.row,r.row),startCol:Math.min(t.column,r.column),finishRow:Math.max(t.row+t.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(t.column+t.colspan-1,r.column+r.colspan-1)};var t,r}))}))}function St(e,n,t){return Ct(e,n,t).map((function(n){return O($t.filterItems(e,h(wt,n)),(function(e){return e.element}))}))}function Tt(e,n){return $t.findItem(e,n,(function(e,n){return ae(n,e)})).map((function(e){return e.element}))}function xt(e,n,t,r,o){var u=Kt(e),i=le(e,t)?U.some(n):Tt(u,n),c=le(e,o)?U.some(r):Tt(u,r);return i.bind((function(e){return c.bind((function(n){return St(u,e,n)}))}))}function Rt(e,n){on(e).each((function(t){t.dom.insertBefore(n.dom,e.dom)}))}function Dt(e,n){ln(e).fold((function(){on(e).each((function(e){Xt(e,n)}))}),(function(e){Rt(e,n)}))}function Ot(e,n){fn(e,0).fold((function(){Xt(e,n)}),(function(t){e.dom.insertBefore(n.dom,t.dom)}))}function At(e,n){Rt(e,n),Xt(n,e)}function kt(e,n){A(n,(function(t,r){Dt(0===r?e:n[r-1],t)}))}function It(e,n){A(n,(function(n){Xt(e,n)}))}function Bt(e){e.dom.textContent="",A(an(e),(function(e){Yt(e)}))}function Mt(e){var n,t=an(e);0<t.length&&(n=e,A(t,(function(e){Rt(n,e)}))),Yt(e)}function Et(e){return Jt.get(e)}function Pt(e){return Jt.getOption(e)}function Nt(e,n){return Jt.set(e,n)}function zt(e,n){return I(z(e.all,(function(e){return e.cells})),n)}var Lt,_t,Wt=function(e,n){e.dom.removeAttribute(n)},jt=function(e,n){return Fn(e)?e.style.getPropertyValue(n):""},Ft=i(10),Ht=i(10),Vt=function e(n,t,r){return z(an(n),(function(n){return ue(n,t)?r(n)?[n]:[]:e(n,t,r)}))},qt=function(e){return rt(e).fold(i([]),(function(e){return dn(e,"colgroup")}))},Ut=function(e,n){return Ce(e.element,n,e.section,e.isNew)},Gt="data-snooker-locked-cols",$t={fromTable:function(e){return vt(ct(e))},generate:vt,getAt:function(e,n,t){return U.from(e.access[n+","+t])},findItem:function(e,n,t){var r=zt(e,(function(e){return t(n,e.element)}));return 0<r.length?U.some(r[0]):U.none()},filterItems:zt,justCells:function(e){return z(e.all,(function(e){return e.cells}))},justColumns:function(e){return ge(e.columns)},hasColumns:function(e){return 0<Ge(e.columns).length},getColumnAt:function(e,n){return U.from(e.columns[n])}},Kt=$t.fromTable,Xt=function(e,n){e.dom.appendChild(n.dom)},Yt=function(e){var n=e.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Jt=(Lt=bn,{get:function(e){if(!Lt(e))throw new Error("Can only get text value of a text node");return _t(e).getOr("")},getOption:_t=function(e){return Lt(e)?U.from(e.dom.nodeValue):U.none()},set:function(e,n){if(!Lt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}),Qt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Zt(){return{up:i({selector:On,closest:In,predicate:Dn,all:un}),down:i({selector:gn,predicate:xn}),styles:i({get:Un,getRaw:Gn,set:Vn,remove:$n}),attrs:i({get:Pn,set:Mn,remove:Wt,copyTo:function(e,n){En(n,zn(e))}}),insert:i({before:Rt,after:Dt,afterAll:kt,append:Xt,appendAll:It,prepend:Ot,wrap:At}),remove:i({unwrap:Mt,remove:Yt}),create:i({nu:qe.fromTag,clone:function(e){return qe.fromDom(e.dom.cloneNode(!1))},text:qe.fromText}),query:i({comparePosition:function(e,n){return e.dom.compareDocumentPosition(n.dom)},prevSibling:cn,nextSibling:ln}),property:i({children:an,name:Je,parent:on,document:function(e){return rn(e).dom},isText:bn,isComment:en,isElement:pn,isSpecial:function(e){return x(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],Je(e))},getLanguage:function(e){return pn(e)?Nn(e,"lang"):U.none()},getText:Et,setText:Nt,isBoundary:function(e){return!!pn(e)&&("body"===Je(e)||x(Qt,Je(e)))},isEmptyTag:function(e){return!!pn(e)&&x(["br","img","hr","input"],Je(e))},isNonEditable:function(e){return pn(e)&&"false"===Pn(e,"contenteditable")}}),eq:le,is:Ue}}function er(e,n){return jr(Hr,(function(n,t){return e(t)}),n)}function nr(e){return On(e,"table")}function tr(e,n,t){function r(e){return function(n){return void 0!==t&&t(n)||le(n,e)}}return le(e,n)?U.some({boxes:U.some([e]),start:e,finish:n}):nr(e).bind((function(o){return nr(n).bind((function(u){if(le(o,u))return U.some({boxes:(a=e,f=n,St(Kt(o),a,f)),start:e,finish:n});if(ae(o,u)){var i=0<(c=mn(n,"td,th",r(o))).length?c[c.length-1]:n;return U.some({boxes:xt(o,e,o,n,u),start:e,finish:i})}if(ae(u,o)){var c,l=0<(c=mn(e,"td,th",r(u))).length?c[c.length-1]:e;return U.some({boxes:xt(u,e,o,n,u),start:e,finish:l})}return Fr(Hr,e,n,void 0).shared.bind((function(i){return In(i,"table",t).bind((function(t){var i=mn(n,"td,th",r(t)),c=0<i.length?i[i.length-1]:n,l=mn(e,"td,th",r(t)),a=0<l.length?l[l.length-1]:e;return U.some({boxes:xt(t,e,o,n,u),start:a,finish:c})}))}));var a,f}))}))}function rr(e,n){var t=gn(e,n);return 0<t.length?U.some(t):U.none()}function or(e,n,t){return kn(e,n).bind((function(n){return kn(e,t).bind((function(e){return er(nr,[n,e]).map((function(t){return{first:n,last:e,table:t}}))}))}))}function ur(e,n,t,r,o){return u=o,E(e,(function(e){return ue(e,u)})).bind((function(e){return u=n,i=t,rt(o=e).bind((function(e){var n=Kt(e),t=u,r=i;return $t.findItem(n,o,le).bind((function(e){var o=0<t?e.row+e.rowspan-1:e.row,u=0<r?e.column+e.colspan-1:e.column;return $t.getAt(n,o+t,u+r).map((function(e){return e.element}))}))})).bind((function(e){return t=r,On(n=e,"table").bind((function(e){return kn(e,t).bind((function(e){return tr(e,n).bind((function(e){return e.boxes.map((function(n){return{boxes:n,start:e.start,finish:e.finish}}))}))}))}));var n,t}));var o,u,i}));var u}function ir(e,n,t,r){return e.fold(n,t,r)}function cr(e,n){return qe.fromDom(e.dom.cloneNode(n))}function lr(e){return cr(e,!1)}function ar(e){return cr(e,!0)}function fr(e,n){var t=qe.fromTag(n);return En(t,zn(e)),t}function sr(e,n){function t(t){var r=n(t);if(r<=0||null===r){var o=Un(t,e);return parseFloat(o)||0}return r}function r(e,n){return M(n,(function(n,t){var r=Un(e,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)}return{set:function(n,t){if(!b(t)&&!t.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+t);var r=n.dom;Fn(r)&&(r.style[e]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(e,n,t){var o=r(e,t);return o<n?n-o:0}}}function mr(){var e=Ve().browser;return e.isIE()||e.isEdge()}function dr(e,n,t){return r=Un(e,n),o=t,u=parseFloat(r),(isNaN(u)?U.none():U.some(u)).getOr(o);var r,o,u}function gr(e){return Un(e,"box-sizing")}function pr(e,n,t,r){return n-dr(e,"padding-"+t,0)-dr(e,"padding-"+r,0)-dr(e,"border-"+t+"-width",0)-dr(e,"border-"+r+"-width",0)}function br(e,n){var t=e.dom,r=t.getBoundingClientRect().width||t.offsetWidth;return"border-box"===n?r:pr(e,r,"left","right")}function hr(e){return Xr.get(e)}function vr(e){return Xr.getOuter(e)}function wr(e,n){void 0===n&&(n=C);var t=e.grid,r=D(t.columns,c),o=D(t.rows,c);return O(r,(function(t){return Qr((function(){return z(o,(function(n){return $t.getAt(e,n,t).filter((function(e){return e.column===t})).toArray()}))}),(function(e){return 1===e.colspan&&n(e.element)}),(function(){return $t.getAt(e,0,t)}))}))}function yr(e){var n=e.grid,t=D(n.rows,c),r=D(n.columns,c);return O(t,(function(n){return Qr((function(){return z(r,(function(t){return $t.getAt(e,n,t).filter((function(e){return e.row===n})).fold(i([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return $t.getAt(e,n,0)}))}))}function Cr(e,n){return function(t){return"rtl"===Zr(t)?n:e}}function Sr(e){return eo.get(e)}function Tr(e){return eo.getOuter(e)}function xr(e,n){return void 0!==e?e:void 0!==n?n:0}function Rr(e){var n=e.dom.ownerDocument,t=n.body,r=n.defaultView,o=n.documentElement;if(t===e.dom)return no(t.offsetLeft,t.offsetTop);var u=xr(null==r?void 0:r.pageYOffset,o.scrollTop),i=xr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=xr(o.clientTop,t.clientTop),l=xr(o.clientLeft,t.clientLeft);return to(e).translate(i-l,u-c)}function Dr(e,n){return{row:e,y:n}}function Or(e,n){return{col:e,x:n}}function Ar(e){return Rr(e).left+vr(e)}function kr(e){return Rr(e).left}function Ir(e,n){return Or(e,kr(n))}function Br(e,n){return Or(e,Ar(n))}function Mr(e){return Rr(e).top}function Er(e,n){return Dr(e,Mr(n))}function Pr(e,n){return Dr(e,Mr(n)+Tr(n))}function Nr(e,n,t){if(0===t.length)return[];var r=O(t.slice(1),(function(n,t){return n.map((function(n){return e(t,n)}))})),o=t[t.length-1].map((function(e){return n(t.length-1,e)}));return r.concat([o])}function zr(e){if(!s(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],t={};return A(e,(function(r,o){var u=Ge(r);if(1!==u.length)throw new Error("one and only one name per case");var i=u[0],c=r[i];if(void 0!==t[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!s(c))throw new Error("case arguments must be an array");n.push(i),t[i]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var u=t.length;if(u!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+u);return{fold:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(n.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+n.length);return n[o].apply(null,t)},match:function(e){var r=Ge(e);if(n.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+r.join(","));if(!L(n,(function(e){return x(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+n.join(", "));return e[i].apply(null,t)},log:function(e){console.log(e,{constructors:n,constructor:i,params:t})}}}})),t}var Lr,_r,Wr,jr=function(e,n,t){return 0<t.length?(r=e,o=n,u=t[0],B(t.slice(1),(function(e,n){var t=o(r,n);return function(e,n,t){return n.bind((function(n){return t.filter(h(e.eq,n))}))}(r,e,t)}),o(r,u))):U.none();var r,o,u},Fr=function(e,n,t,r){function o(e){return P(e,r).fold((function(){return e}),(function(n){return e.slice(0,n+1)}))}void 0===r&&(r=y);var u=[n].concat(e.up().all(n)),i=[t].concat(e.up().all(t)),c=o(u),l=o(i),a=E(c,(function(n){return R(l,h(e.eq,n))}));return{firstpath:c,secondpath:l,shared:a}},Hr=Zt(),Vr=rr,qr=zr([{none:[]},{multiple:["elements"]},{single:["element"]}]),Ur=qr.none,Gr=qr.multiple,$r=qr.single,Kr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Xr=sr("width",(function(e){return e.dom.offsetWidth})),Yr=function(e){return br(e,"content-box")},Jr=function(e){return mr()?br(e,gr(e)):dr(e,"width",e.dom.offsetWidth)},Qr=function(e,n,t){var r=e();return E(r,n).orThunk((function(){return U.from(r[0]).orThunk(t)})).map((function(e){return e.element}))},Zr=function(e){return"rtl"===Un(e,"direction")?"rtl":"ltr"},eo=sr("height",(function(e){var n=e.dom;return Sn(e)?n.getBoundingClientRect().height:n.offsetHeight})),no=function e(n,t){return{left:n,top:t,translate:function(r,o){return e(n+r,t+o)}}},to=function(e){var n,t=e.dom,r=t.ownerDocument.body;return r===t?no(r.offsetLeft,r.offsetTop):Sn(e)?(n=t.getBoundingClientRect(),no(n.left,n.top)):no(0,0)},ro={delta:c,positions:function(e){return Nr(Er,Pr,e)},edge:Mr},oo=Cr({delta:c,edge:kr,positions:function(e){return Nr(Ir,Br,e)}},{delta:function(e){return-e},edge:Ar,positions:function(e){return Nr(Br,Ir,e)}}),uo={delta:function(e,n){return oo(n).delta(e,n)},positions:function(e,n){return oo(n).positions(e,n)},edge:function(e){return oo(e).edge(e)}},io={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},co=(Wr=["Infinity",(Lr="[0-9]+")+"\\."+lo(Lr)+lo(_r="[eE][+-]?[0-9]+"),"\\."+Lr+lo(_r),Lr+lo(_r)].join("|"),new RegExp("^([+-]?(?:"+Wr+"))(.*)$"));function lo(e){return"(?:"+e+")?"}function ao(e,n,t){var r=U.from(e.dom.parentElement).map(qe.fromDom).getOrThunk((function(){return Tn(tn(e))}));return n(e)/t(r)*100}function fo(e,n){Vn(e,"width",n+"px")}function so(e,n){Vn(e,"width",n+"%")}function mo(e,n){Vn(e,"height",n+"px")}function go(e){var n,t,r,o,u,i,c,l,a,f,s=function(e){return mr()?(t=gr(n=e),o=(r=n.dom).getBoundingClientRect().height||r.offsetHeight,"border-box"===t?o:pr(n,o,"top","bottom")):dr(e,"height",e.dom.offsetHeight);var n,t,r,o}(e)+"px";return s?(n=s,t=e,r=Sr,o=mo,f=parseFloat(n),ne(n,"%")&&"table"!==Je(t)?(i=f,c=r,l=o,a=rt(u=t).map((function(e){var n=c(e);return Math.floor(i/100*n)})).getOr(i),l(u,a),a):f):Sr(e)}function po(e,n){return Gn(e,n).orThunk((function(){return Nn(e,n).map((function(e){return e+"px"}))}))}function bo(e){return po(e,"width")}function ho(e){return ao(e,hr,Yr)}function vo(e){return(Ol(e)?hr:Jr)(e)}function wo(e){return go(n=e)/Xn(n,"rowspan");var n}function yo(e,n,t){Vn(e,"width",n+t)}function Co(e){return ao(e,hr,Yr)+"%"}function So(e){return bo(e).getOrThunk((function(){return vo(e)+"px"}))}function To(e){return po(e,"height").getOrThunk((function(){return wo(e)+"px"}))}function xo(e,n,t,r,o,u){return e.filter(r).fold((function(){return u(function(e,n){if(n<0||n>=e.length-1)return U.none();var t=e[n].fold((function(){var t,r;return V((t=e.slice(0,n),(r=G.call(t,0)).reverse(),r),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return U.some({value:e,delta:0})})),r=e[n+1].fold((function(){return V(e.slice(n+1),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return U.some({value:e,delta:1})}));return t.bind((function(e){return r.map((function(n){var t=n.delta+e.delta;return Math.abs(n.value-e.value)/t}))}))}(t,n))}),(function(e){return o(e)}))}function Ro(e,n,t,r){var o=wr(e),u=$t.hasColumns(e)?O($t.justColumns(e),(function(e){return U.from(e.element)})):o,i=[U.some(uo.edge(n))].concat(O(uo.positions(o,n),(function(e){return e.map((function(e){return e.x}))}))),c=v(Yn);return O(u,(function(e,n){return xo(e,n,i,c,(function(e){return l=e,f=(a=Ve().browser).isChrome()||a.isFirefox(),!kl(l)||f?t(e):xo(null!=(u=o[n])?u:U.none(),n,i,c,(function(e){return r(U.some(hr(e)))}),r);var u,l,a,f}),r)}))}function Do(e){return e.map((function(e){return e+"px"})).getOr("")}function Oo(e,n,t){return Ro(e,n,vo,(function(e){return e.getOrThunk(t.minCellWidth)}))}function Ao(e,n,t,r,o){var u=yr(e),i=[U.some(t.edge(n))].concat(O(t.positions(u,n),(function(e){return e.map((function(e){return e.y}))})));return O(u,(function(e,n){return xo(e,n,i,v(Jn),r,o)}))}function ko(e,n){return function(){return Sn(e)?n(e):parseFloat(Gn(e,"width").getOr("0"))}}function Io(e){var n=ko(e,(function(e){return parseFloat(Co(e))})),t=ko(e,hr);return{width:n,pixelWidth:t,getWidths:function(n,t){return r=t,Ro(n,e,ho,(function(e){return e.fold((function(){return r.minCellWidth()}),(function(e){return e/r.pixelWidth()*100}))}));var r},getCellDelta:function(e){return e/t()*100},singleColumnWidth:function(e,n){return[100-e]},minCellWidth:function(){return Ft()/t()*100},setElementWidth:so,adjustTableWidth:function(t){var r=n();so(e,r+t/100*r)},isRelative:!0,label:"percent"}}function Bo(e){var n=ko(e,hr);return{width:n,pixelWidth:n,getWidths:function(n,t){return Oo(n,e,t)},getCellDelta:c,singleColumnWidth:function(e,n){return[Math.max(Ft(),e+n)-e]},minCellWidth:Ft,setElementWidth:fo,adjustTableWidth:function(t){var r=n()+t;fo(e,r)},isRelative:!1,label:"pixel"}}function Mo(e){return"img"===Je(e)?1:Pt(e).fold((function(){return an(e).length}),(function(e){return e.length}))}function Eo(e){return Pt(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf(" ")})).isSome()||x(El,Je(e))}function Po(e){return n=Eo,(t=function(e){for(var r=0;r<e.childNodes.length;r++){var o=qe.fromDom(e.childNodes[r]);if(n(o))return U.some(o);var u=t(e.childNodes[r]);if(u.isSome())return u}return U.none()})(e.dom);var n,t}function No(e){return Pl(e,Eo)}function zo(e){return function(){var n=qe.fromTag("td",e.dom);return Xt(n,qe.fromTag("br",e.dom)),n}}function Lo(e){return function(){return qe.fromTag("col",e.dom)}}function _o(e){return function(){return qe.fromTag("colgroup",e.dom)}}function Wo(e){return function(){return qe.fromTag("tr",e.dom)}}function jo(e,n,t){var r,o,u=(It(o=fr(r=e,n),an(ar(r))),o);return fe(t,(function(e,n){null===e?Wt(u,n):Mn(u,n,e)})),u}function Fo(e){return e}function Ho(e,n,t){function r(e,n){var t=e.element.dom,r=n.dom;Fn(t)&&Fn(r)&&(r.style.cssText=t.style.cssText),$n(n,"height"),1!==e.colspan&&$n(n,"width")}return{col:function(t){var o=qe.fromTag(Je(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:_o(n),row:Wo(n),cell:function(o){var u,i,c,l,a,f=qe.fromTag(Je(o.element),n.dom),s=t.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=0<s.length?(u=o.element,i=f,c=s,Po(u).map((function(e){return B(mn(e,c.join(","),(function(e){return le(e,u)})),(function(e,n){var t=lr(n);return Wt(t,"contenteditable"),Xt(e,t),t}),i)})).getOr(i)):f;return Xt(m,qe.fromTag("br")),r(o,f),l=o.element,a=f,fe(Nl,(function(e,n){return Nn(l,n).filter((function(n){return x(e,n)})).each((function(e){return Mn(a,n,e)}))})),e(o.element,f),f},replace:jo,colGap:Lo(n),gap:zo(n)}}function Vo(e){return{col:Lo(e),colgroup:_o(e),row:Wo(e),cell:zo(e),replace:Fo,colGap:Lo(e),gap:zo(e)}}function qo(e){return O(e,qe.fromDom)}function Uo(e){return qe.fromDom(e.getBody())}function Go(e){return e.getBoundingClientRect().width}function $o(e){return e.getBoundingClientRect().height}function Ko(e){return function(n){return le(n,Uo(e))}}function Xo(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e}function Yo(e){function n(e){return Wt(e,"data-mce-style")}Wt(e,"data-mce-style"),A(nt(e),n),A(tt(e),n)}function Jo(e){return qe.fromDom(e.selection.getStart())}function Qo(e){return ir(e.get(),i([]),c,W)}function Zo(e,n,t){return{element:t,mergable:(u=n,i=zl,ir(e.get(),U.none,(function(e){return e.length<=1?U.none():function(e,n,t){return or(e,n,t).bind((function(n){function t(n){return le(e,n)}var r="thead,tfoot,tbody,table",o=On(n.first,r,t),u=On(n.last,r,t);return o.bind((function(e){return u.bind((function(t){return le(e,t)?(o=n.table,u=n.first,i=n.last,c=Kt(o),Ct(r=c,u,i).bind((function(e){return function(e,n){for(var t=!0,r=h(yt,n),o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++)t=t&&$t.getAt(e,o,u).exists(r);return t?U.some(n):U.none()}(r,e)}))):U.none();var r,o,u,i,c}))}))}))}(u,i.firstSelectedSelector,i.lastSelectedSelector).map((function(n){return{bounds:n,cells:e}}))}),U.none)),unmergable:0<(o=Qo(e)).length&&L(o,(function(e){return r(e,"rowspan")||r(e,"colspan")}))?U.some(o):U.none(),selection:Qo(e)};function r(e,n){return Nn(e,n).exists((function(e){return 1<parseInt(e,10)}))}var o,u,i}function eu(e){return function(n,t){var r,o=Je(n);return In("col"===o||"colgroup"===o?rt(r=n).bind((function(e){return Vr(e,zl.firstSelectedSelector)})).fold(i(r),(function(e){return e[0]})):n,e,t)}}function nu(e,n,t){e.on("BeforeGetContent",(function(t){!0===t.selection&&ir(n.get(),u,(function(n){t.preventDefault(),rt(n[0]).map((function(e){var n=function(e,n){function t(e){return ue(e.element,n)}var r,o,u,i,c,l,a,f,s,m,d,g,p=ar(e),b=ct(p),h=Il(e),v=$t.generate(b),w=(r=t,o=v.grid.columns,u=v.grid.rows,i=o,l=c=0,a=[],f=[],fe(v.access,(function(e){var n,t,o,s;a.push(e),r(e)&&(f.push(e),t=(n=e.row)+e.rowspan-1,s=(o=e.column)+e.colspan-1,n<u?u=n:c<t&&(c=t),o<i?i=o:l<s&&(l=s))})),{minRow:u,minCol:i,maxRow:c,maxCol:l,allCells:a,selectedCells:f}),y="th:not("+n+"),td:not("+n+")";return A(Vt(p,"th,td",(function(e){return ue(e,y)})),Yt),function(e,n,t,r){for(var o,u,i,c=n.grid.columns,l=n.grid.rows,a=0;a<l;a++)for(var f=!1,s=0;s<c;s++)a<t.minRow||a>t.maxRow||s<t.minCol||s>t.maxCol||($t.getAt(n,a,s).filter(r).isNone()?(o=f,u=e[a].element,i=qe.fromTag("td"),Xt(i,qe.fromTag("br")),(o?Xt:Ot)(u,i)):f=!0)}(b,v,w,t),s=p,m=w,d=v,g=function(e,n,t,r){if(0===r.minCol&&n.grid.columns===r.maxCol+1)return 0;var o=Oo(n,e,t),u=M(o,(function(e,n){return e+n}),0),i=M(o.slice(r.minCol,r.maxCol+1),(function(e,n){return e+n}),0)/u*t.pixelWidth()-t.pixelWidth();return t.getCellDelta(i)}(e,$t.fromTable(e),h,w),fe(d.columns,(function(e){(e.column<m.minCol||e.column>m.maxCol)&&Yt(e.element)})),A(I(Zn(s,"tr"),(function(e){return 0===e.dom.childElementCount})),Yt),m.minCol!==m.maxCol&&m.minRow!==m.maxRow||A(Zn(s,"th,td"),(function(e){Wt(e,"rowspan"),Wt(e,"colspan")})),Wt(s,Gt),Wt(s,"data-snooker-col-series"),Il(s).adjustTableWidth(g),p}(e,"[data-mce-selected]");return Yo(n),[n]})).each((function(n){var r;t.content="text"===t.format?O(n,(function(e){return e.dom.innerText})).join(""):(r=e,O(n,(function(e){return r.selection.serializer.serialize(e.dom,{})})).join(""))}))}),u)})),e.on("BeforeSetContent",(function(r){!0===r.selection&&!0===r.paste&&F(Wl(n)).each((function(n){rt(n).each((function(o){var u,i,c,l,a=I((u=r.content,(i=document.createElement("div")).innerHTML=u,an(qe.fromDom(i))),(function(e){return"meta"!==Je(e)})),f=nn("table");1===a.length&&f(a[0])&&(r.preventDefault(),c=Vo(qe.fromDom(e.getDoc())),l={element:n,clipboard:a[0],generators:c},t.pasteCells(o,l).each((function(){e.focus()})))}))}))}))}function tu(e,n,t){for(var r=0,o=e;o<n;o++)r+=void 0!==t[o]?t[o]:0;return r}function ru(e,n,t){var r,o,u,i;A((r=e,o=n,$t.hasColumns(r)?(i=o,O($t.justColumns(r),(function(e,n){return{element:e.element,width:i[n],colspan:e.colspan}}))):(u=o,O($t.justCells(r),(function(e){var n=tu(e.column,e.column+e.colspan,u);return{element:e.element,width:n,colspan:e.colspan}})))),(function(e){t.setElementWidth(e.element,e.width)}))}function ou(e,n,t,r,o){var u,c,l,a,f,s,m,d,g,p,b=$t.fromTable(e),h=o.getCellDelta(n),v=o.getWidths(b,o),w=t===b.grid.columns-1,y=r.clampTableDelta(v,t,h,o.minCellWidth(),w),C=(c=t,l=y,a=o,f=r,d=(u=v).slice(0),m=c,g=0===(s=u).length?Fl.none():1===s.length?Fl.only(0):0===m?Fl.left(0,1):m===s.length-1?Fl.right(m-1,m):0<m&&m<s.length-1?Fl.middle(m-1,m,m+1):Fl.none(),p=i(O(d,i(0))),g.fold(p,(function(e){return a.singleColumnWidth(d[e],l)}),(function(e,n){return f.calcLeftEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)}),(function(e,n,t){return f.calcMiddleDeltas(d,e,n,t,l,a.minCellWidth(),a.isRelative)}),(function(e,n){return f.calcRightEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)})));ru(b,O(C,(function(e,n){return e+v[n]})),o),r.resizeTable(o.adjustTableWidth,y,w)}function uu(e){return O(e,i(0))}function iu(e,n,t,r,o){return o(e.slice(0,n)).concat(r).concat(o(e.slice(t)))}function cu(e){return function(n,t,r,o){if(e(r)){var u=Math.max(o,n[t]-Math.abs(r)),i=Math.abs(u-n[t]);return 0<=r?i:-i}return r}}function lu(){function e(e,n,t,r){var o=(100+t)/100,u=Math.max(r,(e[n]+t)/o);return O(e,(function(e,t){return(t===n?u:e/o)-e}))}function n(n,t,r,o,u,i){return i?e(n,t,o,u):(a=r,f=Hl(c=n,l=t,o,u),iu(c,l,a+1,[f,0],uu));var c,l,a,f}return{resizeTable:function(e,n){return e(n)},clampTableDelta:Hl,calcLeftEdgeDeltas:n,calcMiddleDeltas:function(e,t,r,o,u,i,c){return n(e,r,o,u,i,c)},calcRightEdgeDeltas:function(n,t,r,o,u,i){if(i)return e(n,r,o,u);var c=Hl(n,r,o,u);return uu(n.slice(0,r)).concat([c])},calcRedestributedWidths:function(e,n,t,r){if(r){var o=(n+t)/n,u=O(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:u}}return{delta:t,newSizes:e}}}}function au(){function e(e,n,t,r,o){var u=Vl(e,0<=r?t:n,r,o);return iu(e,n,t+1,[u,-u],uu)}return{resizeTable:function(e,n,t){t&&e(n)},clampTableDelta:function(e,n,t,r,o){if(o){if(0<=t)return t;var u=M(e,(function(e,n){return e+n-r}),0);return Math.max(-u,t)}return Hl(e,n,t,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(n,t,r,o,u,i){return e(n,r,o,u,i)},calcRightEdgeDeltas:function(e,n,t,r,o,u){return u?uu(e):O(e,i(r/e.length))},calcRedestributedWidths:function(e,n,t,r){return{delta:0,newSizes:e}}}}function fu(e,n,t){var r=t.substring(0,t.length-e.length),o=parseFloat(r);return r===o.toString()?n(o):ql.invalid(t)}function su(e,n,t){var r,o,u,c,l=Ul.from(t),a=L(e,(function(e){return"0px"===e}))?(r=e.length,o=l.fold((function(){return i("")}),(function(e){return i(e/r+"px")}),(function(){return i(100/r+"%")})),D(r,o)):(u=e,c=n,l.fold((function(){return u}),(function(e){return t=(n=e)/c,O(u,(function(e){return Ul.from(e).fold((function(){return e}),(function(e){return e*t+"px"}),(function(e){return e/100*n+"px"}))}));var n,t}),(function(e){return n=c,O(u,(function(e){return Ul.from(e).fold((function(){return e}),(function(e){return e/n*100+"%"}),(function(e){return e+"%"}))}));var n})));return Gl(a)}function mu(e,n){return 0===e.length?n:B(e,(function(e,n){return Ul.from(n).fold(i(0),c,c)+e}),0)}function du(e){return $l(e).fold(i("px"),i("px"),i("%"))}function gu(e,n,t){var r=$t.fromTable(e),o=r.all,u=$t.justCells(r),i=$t.justColumns(r);n.each((function(n){var t,o,c,l,a=du(n),f=hr(e),s=su(Ro(r,e,So,Do),f,n);$t.hasColumns(r)?(c=s,l=a,A(i,(function(e,n){var t=mu([c[n]],Ft());Vn(e.element,"width",t+l)}))):(t=s,o=a,A(u,(function(e){var n=mu(t.slice(e.column,e.colspan+e.column),Ft());Vn(e.element,"width",n+o)}))),Vn(e,"width",n)})),t.each((function(n){var t=du(n),i=Sr(e),c=su(Ao(r,e,ro,To,Do),i,n),l=o,a=t;A(u,(function(e){var n=mu(c.slice(e.row,e.rowspan+e.row),Ht());Vn(e.element,"height",n+a)})),A(l,(function(e,n){Vn(e.element,"height",c[n])})),Vn(e,"height",n)}))}function pu(e){return $t.fromTable(e).grid}function bu(e){var n=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");n.push(e)},unbind:function(e){n=I(n,(function(n){return n!==e}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o={};A(e,(function(e,n){o[e]=t[n]})),A(n,(function(e){e(o)}))}}}function hu(e){return{registry:se(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:se(e,(function(e){return e.trigger}))}}function vu(e){return e.slice(0).sort()}function wu(e,n){var t=I(n,(function(n){return!x(e,n)}));0<t.length&&function(){throw new Error("Unsupported keys for object: "+vu(t).join(", "))}()}function yu(e){return function(e,n,t){if(0===n.length)throw new Error("You must specify at least one required field.");var r;return function(e,n){if(!s(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");A(n,(function(n){if(!a(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")}))}("required",n),E(r=vu(n),(function(e,n){return n<r.length-1&&e===r[n+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Ge(r);L(n,(function(e){return x(o,e)}))||function(e,n){throw new Error("All required keys ("+vu(e).join(", ")+") were not specified. Specified keys were: "+vu(n).join(", ")+".")}(n,o),e(n,o);var u=I(n,(function(e){return!t.validate(r[e],e)}));return 0<u.length&&function(e,n){throw new Error("All values need to be of type: "+n+". Keys ("+vu(e).join(", ")+") were not.")}(u,t.label),r}}(wu,e,{validate:p,label:"function"})}function Cu(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var r,u,i=qe.fromDom(function(e){if(yn()&&o(e.target)){var n=qe.fromDom(e.target);if(pn(n)&&function(e){return o(e.dom.shadowRoot)}(n)&&e.composed&&e.composedPath){var t=e.composedPath();if(t)return F(t)}}return U.from(e.target)}(e).getOr(e.target)),c=(r=t,u=n,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r(u.apply(null,e))});return{target:i,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:c,raw:e}}function Su(e,n,t){return o=n,!1,u=Ql,i=t,c=function(e){u(e)&&i(Cu(e))},(r=e).dom.addEventListener(o,c,false),{unbind:h(Jl,r,o,c,false)};var r,o,u,i,c}function Tu(e){return void 0!==e.dom.classList}function xu(e,n){Tu(e)?e.dom.classList.add(n):function(e,n){return r=n,Mn(e,"class",(void 0===(t=Pn(e,"class"))||""===t?[]:t.split(" ")).concat([r]).join(" ")),1;var t,r}(e,n)}function Ru(e,n){return Tu(e)&&e.dom.classList.contains(n)}function Du(e){var n=e.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}}function Ou(e){return In(e,"[contenteditable]")}function Au(e,n){return void 0===n&&(n=!1),!Ve().browser.isIE()&&Sn(e)?e.dom.isContentEditable:Ou(e).fold(i(n),(function(e){return"true"===ta(e)}))}function ku(e){A(gn(e.parent(),"."+oa),Yt)}function Iu(e,n,t){var r=e.origin();A(n,(function(n){n.each((function(n){var o=t(r,n);xu(o,oa),Xt(e.parent(),o)}))}))}function Bu(e,n){var t;ku(e),e.isResizable(n)&&function(e,n,t,r,o){var u,i,c,l,a,f=Rr(t),s=n.isResizable,m=0<r.length?ro.positions(r,t):[],d=0<m.length?(u=s,z(e.all,(function(e,n){return u(e.element)?[n]:[]}))):[],g=I(m,(function(e,n){return R(d,(function(e){return n===e}))}));i=n,c=g,l=f,a=vr(t),Iu(i,c,(function(e,n){var t,r,o,u,i,c=(t=n.row,r=l.left-e.left,o=n.y-e.top,u=a,qn(i=qe.fromTag("div"),{position:"absolute",left:r+"px",top:o-3.5+"px",height:"7px",width:u+"px"}),En(i,{"data-row":t,role:"presentation"}),i);return xu(c,ua),c}));var p,b,h,v,w,y,C,S=0<o.length?uo.positions(o,t):[],T=0<S.length?(b=s,h=[],D((p=e).grid.columns,(function(e){$t.getColumnAt(p,e).map((function(e){return e.element})).forall(b)&&h.push(e)})),I(h,(function(e){return L($t.filterItems(p,(function(n){return n.column===e})),(function(e){return b(e.element)}))}))):[],x=I(S,(function(e,n){return R(T,(function(e){return n===e}))}));v=n,w=x,y=f,C=Tr(t),Iu(v,w,(function(e,n){var t,r,o,u,i,c=(t=n.col,r=n.x-e.left,o=y.top-e.top,u=C,qn(i=qe.fromTag("div"),{position:"absolute",left:r-3.5+"px",top:o+"px",height:u+"px",width:"7px"}),En(i,{"data-column":t,role:"presentation"}),i);return xu(c,ia),c}))}(t=$t.fromTable(n),e,n,yr(t),wr(t))}function Mu(e,n){A(gn(e.parent(),"."+oa),n)}function Eu(e){Mu(e,(function(e){Vn(e,"display","none")}))}function Pu(e){Mu(e,(function(e){Vn(e,"display","block")}))}function Nu(e){function n(e,n){return U.from(Pn(e,n))}var t,r,o,i,c,l,a=(i=hu({drag:bu(["xDelta","yDelta","target"])}),c=U.none(),(l={mutate:function(e,n){o.trigger.drag(e,n)},events:(o=hu({drag:bu(["xDelta","yDelta"])})).registry}).events.drag.bind((function(e){c.each((function(n){i.trigger.drag(e.xDelta,e.yDelta,n)}))})),{assign:function(e){c=U.some(e)},get:function(){return c},mutate:l.mutate,events:i.registry}),f=(r=void 0!==(t={}).mode?t.mode:na,function(e,n,t){function r(){g.stop(),a.isOn()&&(a.off(),l.trigger.stop())}var o,i,c=!1,l=hu({start:bu([]),stop:bu([])}),a=function(){var e,n,t={onEvent:u,reset:u,events:hu({move:bu(["info"])}).registry},r=(e=U.none(),{onEvent:function(t,r){r.extract(t).each((function(t){var o=r,u=t,i=e.map((function(e){return o.compare(e,u)}));e=U.some(u),i.each((function(e){n.trigger.move(e)}))}))},reset:function(){e=U.none()},events:(n=hu({move:bu(["info"])})).registry}),o=t;return{on:function(){o.reset(),o=r},off:function(){o.reset(),o=t},isOn:function(){return o===r},onEvent:function(e,n){o.onEvent(e,n)},events:r.events}}(),f=(o=r,i=null,{cancel:s,throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];s(),i=setTimeout((function(){i=null,o.apply(null,e)}),200)}});function s(){m(i)||(clearTimeout(i),i=null)}function d(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];c&&e.apply(null,n)}}a.events.move.bind((function(t){n.mutate(e,t.info)}));var g=n.sink(Yl({forceDrop:r,drop:d(r),move:d((function(e){f.cancel(),a.onEvent(e,n)})),delayDrop:d(f.throttle)}),t);return{element:g.element,go:function(e){g.start(e),a.on(),l.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){g.destroy()},events:l.registry}}(a,r,t)),s=U.none();function d(e,n){return Qn(e,n)-Kn(e,"data-initial-"+n,0)}function g(n,t){w.trigger.startAdjust(),a.assign(n),Mn(n,"data-initial-"+t,Qn(n,t)),xu(n,ca),Vn(n,"opacity","0.2"),f.go(e.parent())}function p(n){return le(n,e.view())}a.events.drag.bind((function(e){n(e.target,"data-row").each((function(n){var t=Qn(e.target,"top");Vn(e.target,"top",t+e.yDelta+"px")})),n(e.target,"data-column").each((function(n){var t=Qn(e.target,"left");Vn(e.target,"left",t+e.xDelta+"px")}))})),f.events.stop.bind((function(){a.get().each((function(t){s.each((function(r){n(t,"data-row").each((function(e){var n=d(t,"top");Wt(t,"data-initial-top"),w.trigger.adjustHeight(r,n,parseInt(e,10))})),n(t,"data-column").each((function(e){var n=d(t,"left");Wt(t,"data-initial-left"),w.trigger.adjustWidth(r,n,parseInt(e,10))})),Bu(e,r)}))}))}));var b=Su(e.parent(),"mousedown",(function(e){Ru(e.target,ua)&&g(e.target,"top"),Ru(e.target,ia)&&g(e.target,"left")})),v=Su(e.view(),"mouseover",(function(n){In(n.target,"table",p).filter(Au).fold((function(){Sn(n.target)&&ku(e)}),(function(n){s=U.some(n),Bu(e,n)}))})),w=hu({adjustHeight:bu(["table","delta","row"]),adjustWidth:bu(["table","delta","column"]),startAdjust:bu([])});return{destroy:function(){b.unbind(),v.unbind(),f.destroy(),ku(e)},refresh:function(n){Bu(e,n)},on:f.on,off:f.off,hideBars:h(Eu,e),showBars:h(Pu,e),events:w.registry}}function zu(e,n){return e.fire("newrow",{node:n})}function Lu(e,n){return e.fire("newcell",{node:n})}function _u(e,n,t){e.fire("TableModified",X(X({},t),{table:n}))}function Wu(e){return e.getParam("table_sizing_mode","auto")}function ju(e){return e.getParam("table_responsive_width")}function Fu(e){return e.getParam("table_border_widths",ma,"array")}function Hu(e){return e.getParam("table_border_styles",da,"array")}function Vu(e){return e.getParam("table_default_attributes",ga,"object")}function qu(e){return e.getParam("table_default_styles",function(e){var n;if(ba(e)){var t=e.dom,r=null!==(n=t.getParent(e.selection.getStart(),t.isBlock))&&void 0!==n?n:e.getBody(),o=Yr(qe.fromDom(r));return X(X({},sa),{width:o+"px"})}return ha(e)?me(sa,(function(e,n){return"width"!==n})):sa}(e),"object")}function Uu(e){return e.getParam("table_cell_advtab",!0,"boolean")}function Gu(e){return e.getParam("table_row_advtab",!0,"boolean")}function $u(e){return e.getParam("table_advtab",!0,"boolean")}function Ku(e){return e.getParam("table_style_by_css",!1,"boolean")}function Xu(e){return e.getParam("table_cell_class_list",[],"array")}function Yu(e){return e.getParam("table_class_list",[],"array")}function Ju(e){return"relative"===Wu(e)||!0===ju(e)}function Qu(e){var n="section",t=e.getParam("table_header_type",n,"string");return x(["section","cells","sectionCells","auto"],t)?t:n}function Zu(e){var n=e.getParam("table_column_resizing",pa,"string");return E(["preservetable","resizetable"],(function(e){return e===n})).getOr(pa)}function ei(e){return"preservetable"===Zu(e)}function ni(e){return"resizetable"===Zu(e)}function ti(e){var n=e.getParam("table_clone_elements");return a(n)?U.some(n.split(/[ ,]/)):Array.isArray(n)?U.some(n):U.none()}function ri(e){return e.getParam("table_background_color_map",[],"array")}function oi(e){return e.getParam("table_border_color_map",[],"array")}function ui(e,n){return(Ju(e)?Ml:ba(e)?Bl:Il)(n)}function ii(e){Wt(e,"width")}function ci(e){return"false"!==Pn(e,"data-mce-resize")}function li(e,n){return{element:e,offset:n}}function ai(e,n){return(e.property().isText(n)?e.property().getText(n):e.property().children(n)).length}function fi(e,n){1===Xn(e,"colspan")&&bo(e).bind((function(e){return n=["fixed","relative","empty"],U.from(co.exec(e)).bind((function(e){var t=Number(e[1]),r=e[2],o=r;return R(n,(function(e){return R(io[e],(function(e){return o===e}))}))?U.some({value:t,unit:r}):U.none()}));var n})).each((function(t){var r=t.value/2;yo(e,r,t.unit),yo(n,r,t.unit)}))}function si(e){return L(e,(function(e){return Ra(e.element)}))}function mi(e){var n="thead"===e.section,t=Ln(Da(e.cells),"th");return n||t?{type:"header",subType:n&&t?"sectionCells":n?"section":"cells"}:"tfoot"===e.section?{type:"footer"}:{type:"body"}}function di(e,n,t){return ye(t(e.element,n),!0,e.isLocked)}function gi(e,n){return e.section!==n?Ce(e.element,e.cells,n,e.isNew):e}function pi(){return{transformRow:gi,transformCell:function(e,n,t){var r,o,u=t(e.element,n);return ye("td"!==Je(u)?(o=fr(r=u,"td"),Rt(r,o),It(o,an(r)),Yt(r),o):u,e.isNew,e.isLocked)}}}function bi(){return{transformRow:gi,transformCell:di}}function hi(){return{transformRow:function(e,n){return gi(e,"thead"===n?"tbody":n)},transformCell:di}}function vi(e,n,t,r){t===r?Wt(e,n):Mn(e,n,t)}function wi(e,n,t){H(dn(e,n)).fold((function(){return Ot(e,t)}),(function(e){return Dt(e,t)}))}function yi(e,n){function t(n,t){0<n.length?function(n,t){var u,i,c;It((Bt(c=An(u=e,i=t).getOrThunk((function(){var e=qe.fromTag(i,tn(u).dom);return"thead"===i?wi(u,"caption,colgroup",e):"colgroup"===i?wi(u,"caption",e):Xt(u,e),e}))),c),("colgroup"===t?function(e){return z(e,(function(e){return O(e.cells,(function(e){return vi(e.element,"span",e.colspan,1),e.element}))}))}:function(e){return O(e,(function(e){e.isNew&&r.push(e.element);var n=e.element;return Bt(n),A(e.cells,(function(e){e.isNew&&o.push(e.element),vi(e.element,"colspan",e.colspan,1),vi(e.element,"rowspan",e.rowspan,1),Xt(n,e.element)})),n}))})(n))}(n,t):An(e,t).each(Yt)}var r=[],o=[],u=[],i=[],c=[],l=[];return A(n,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":i.push(e);break;case"tfoot":c.push(e);break;case"colgroup":l.push(e)}})),t(l,"colgroup"),t(u,"thead"),t(i,"tbody"),t(c,"tfoot"),{newRows:r,newCells:o}}function Ci(e,n){if(0===e.length)return 0;var t=e[0];return P(e,(function(e){return!n(t.element,e.element)})).getOr(e.length)}function Si(e,n,t){var r=[];A(e.colgroups,(function(o){for(var u=[],i=0;i<e.grid.columns;i++){var c=$t.getColumnAt(e,i).map((function(e){return ye(e.element,t,!1)})).getOrThunk((function(){return ye(n.colGap(),!0,!1)}));u.push(c)}r.push(Ce(o.element,u,"colgroup",t))}));for(var o=0;o<e.grid.rows;o++){for(var u=[],i=0;i<e.grid.columns;i++){var c=$t.getAt(e,o,i).map((function(e){return ye(e.element,t,e.isLocked)})).getOrThunk((function(){return ye(n.gap(),!0,!1)}));u.push(c)}var l=e.all[o],a=Ce(l.element,u,l.section,t);r.push(a)}return r}function Ti(e){return function(e,n){var t=O(e,(function(e){return O(e.cells,y)}));return O(e,(function(r,o){var u=z(r.cells,(function(r,u){if(!1!==t[o][u])return[];var i,c,l,a,f,s,m,d,g=(l=u,a=n,d="colgroup"===(m=(i=e)[c=o]).section,{colspan:Ci(m.cells.slice(l),a),rowspan:d?1:Ci((f=i.slice(c),s=l,O(f,(function(e){return st(e,s)}))),a)});return function(e,n,r,o){for(var u=e;u<e+r;u++)for(var i=n;i<n+o;i++)t[u][i]=!0}(o,u,g.rowspan,g.colspan),[{element:r.element,rowspan:g.rowspan,colspan:g.colspan,isNew:r.isNew}]}));return{element:r.element,cells:u,section:r.section,isNew:r.isNew}}))}(e,le)}function xi(e,n){return V(e.all,(function(e){return E(e.cells,(function(e){return le(n,e.element)}))}))}function Ri(e,n,t){var r=_n(O(n.selection,(function(n){return et(n).bind((function(n){return xi(e,n)})).filter(t)})));return jn(0<r.length,r)}function Di(e,n,t,r,o){return function(u,i,c,l,a){var f=$t.fromTable(i),s=U.from(null==a?void 0:a.section).getOrThunk(Cl);return n(f,c).map((function(n){var t=Si(f,l,!1),r=e(t,n,le,o(l),s),u=ht(r.grid);return{info:n,grid:Ti(r.grid),cursor:r.cursor,lockedColumns:u}})).bind((function(e){var n=yi(i,e.grid),o=U.from(null==a?void 0:a.sizing).getOrThunk((function(){return Il(i)})),c=U.from(null==a?void 0:a.resize).getOrThunk(au);return t(i,e.grid,e.info,{sizing:o,resize:c,section:s}),r(i),Bu(u,i),Wt(i,Gt),0<e.lockedColumns.length&&Mn(i,Gt,e.lockedColumns.join(",")),U.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})}))}}function Oi(e,n){return Ri(e,n,C).map((function(e){return{cells:e,generators:n.generators,clipboard:n.clipboard}}))}function Ai(e,n){return Ri(e,n,C)}function ki(e,n){return Ri(e,n,(function(e){return!e.isLocked}))}function Ii(e,n){return L(n,(function(n){return xi(e,n).exists((function(e){return!e.isLocked}))}))}function Bi(e,n){return n.mergable.filter((function(n){return Ii(e,n.cells)}))}function Mi(e,n){return n.unmergable.filter((function(n){return Ii(e,n)}))}function Ei(e,n,t,r){for(var o=gt(e).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<dt(o[0]);c++){var l=o[i],a=st(l,c),f=t(a.element,n);!0===f&&!1===u?ft(l,c,ye(r(),!0,a.isLocked)):!0===f&&(u=!1)}return e}function Pi(e,n){return{rowDelta:0,colDelta:dt(e[0])-dt(n[0])}}function Ni(e,n){return{rowDelta:e.length-n.length,colDelta:0}}function zi(e,n,t,r){var o="colgroup"===n.section?t.col:t.cell;return D(e,(function(e){return ye(o(),!0,r(e))}))}function Li(e,n,t,r){var o=e[e.length-1];return e.concat(D(n,(function(){var e="colgroup"===o.section?t.colgroup:t.row,n=pt(o,e,c),u=zi(n.cells.length,n,t,(function(e){return Xe(r,e.toString())}));return Ut(n,u)})))}function _i(e,n,t,r){return O(e,(function(e){var o=zi(n,e,t,y);return lt(e,r,o)}))}function Wi(e,n,t){var r=n.colDelta<0?_i:c,o=n.rowDelta<0?Li:c,u=ht(e),i=dt(e[0]),l=R(u,(function(e){return e===i-1})),a=r(e,Math.abs(n.colDelta),t,l?i-1:i),f=ht(a);return o(a,Math.abs(n.rowDelta),t,_(f,C))}function ji(e,n,t){return I(t,(function(t){return t>=e.column&&t<=dt(n[0])+e.column}))}function Fi(e,n,t,r,o){var u=e,i=o,c=r.cell;0<u&&u<n[0].cells.length&&A(n,(function(e){var n=e.cells[u-1],t=e.cells[u];i(t.element,n.element)&&ft(e,u,ye(c(),!0,t.isLocked))}));var l=Wi(t,Ni(t,n),r);return O(Wi(n,Ni(n,l),r),(function(n,t){return lt(n,e,l[t].cells)}))}function Hi(e,n,t,r,o){!function(e,n,t,r){var o,u,i=gt(e).rows;0<n&&n<i.length&&(o=i[n-1].cells,u=t,A(M(o,(function(e,n){return R(e,(function(e){return u(e.element,n.element)}))?e:e.concat([n])}),[]),(function(e){for(var o=U.none(),u=n;u<i.length;u++)for(var c=0;c<dt(i[0]);c++)!function(n){var c=i[u],l=st(c,n);t(l.element,e.element)&&(o=o.isNone()?U.some(r()):o).each((function(e){ft(c,n,ye(e,!0,l.isLocked))}))}(c)})))}(n,e,o,r.cell);var u,i,c=ht(n),l=Pi(n,t),a=Wi(n,X(X({},l),{colDelta:l.colDelta-c.length}),r),f=gt(a),s=f.cols,m=f.rows,d=ht(a),g=Pi(t,n),p=X(X({},g),{colDelta:g.colDelta+d.length}),b=Wi((u=r,i=d,O(t,(function(e){return M(i,(function(n,t){return at(n,t,zi(1,e,u,C)[0])}),e)}))),p,r);return s.concat(m.slice(0,e)).concat(b).concat(m.slice(e,m.length))}function Vi(e,n,t,r,o){var u,i,c,l,a=gt(e),f=a.rows,s=a.cols,m=f.slice(0,n),d=f.slice(n),g=(u=f[t],i=function(e,t){return 0<n&&n<f.length&&r(mt(f[n-1],t),mt(f[n],t))?st(f[n],t):ye(o(e.element,r),!0,e.isLocked)},c=r,l=o,pt(u,(function(e){return l(e,c)}),i));return s.concat(m).concat([g]).concat(d)}function qi(e,n,t,r,o){return O(e,(function(e){var u,i,c=0<n&&n<dt(e)&&r(mt(e,n-1),mt(e,n)),l=(u=e.section,i=o,"colgroup"!==u&&c?st(e,n):ye(i(st(e,t).element,r),!0,!1));return at(e,n,l)}))}function Ui(e,n,t,r){return void 0!==mt((u=e)[i=n],t)&&0<i&&r(mt(u[i-1],t),mt(u[i],t))||(o=e[n],0<t&&r(mt(o,t-1),mt(o,t)));var o,u,i}function Gi(e,n,t,r){function o(e){return("row"===e?Jn:Yn)(n)?e+"group":e}return e?Ra(n)?o(t):null:r&&Ra(n)?o("row"===t?"col":"row"):null}function $i(e,n,t){return ye(t(e.element,n),!0,e.isLocked)}function Ki(e,n,t,r,o,u,i){return O(e,(function(e,c){return a=function(e,l){if(f=e,R(n,(function(e){return t(f.element,e.element)}))){var a=i(e,c,l)?o(e,t,r):e;return u(a,c,l).each((function(e){var n=a.element;fe({scope:U.from(e)},(function(e,t){e.fold((function(){Wt(n,t)}),(function(e){Bn(n.dom,t,e)}))}))})),a}return e;var f},f=O((l=e).cells,a),Ce(l.element,f,l.section,l.isNew);var l,a,f}))}function Xi(e,n,t){return z(e,(function(r,o){return Ui(e,o,n,t)?[]:[st(r,n)]}))}function Yi(e,n,t,r,o){var u,i,l,a,f=gt(e).rows,s=z(n,(function(e){return Xi(f,e,r)})),m=O(e,(function(e){return si(e.cells)})),d=(u=s,L(i=m,c)&&si(u)?C:function(e,n,t){return!("th"===Je(e.element)&&i[n])}),g=(l=t,a=m,function(e,n){return U.some(Gi(l,e.element,"row",a[n]))});return Ki(e,s,r,o,$i,g,d)}function Ji(e,n,t,r){var o=gt(e).rows;return Ki(e,O(n,(function(e){return st(o[e.row],e.column)})),t,r,$i,U.none,C)}function Qi(e){return M(e,(function(e,n){return R(e,(function(e){return e.column===n.column}))?e:e.concat([n])}),[]).sort((function(e,n){return e.column-n.column}))}function Zi(e){return"tr"===Je(e)||Pa(e)}function ec(e){return{element:e,colspan:Kn(e,"colspan",1),rowspan:Kn(e,"rowspan",1)}}function nc(e){return Nn(e,"scope").map((function(e){return e.substr(0,3)}))}function tc(e){return n=e,t=za.property().name(n),x(Na,t);var n,t}function rc(e){return n=e,x(["ol","ul"],za.property().name(n));var n}function oc(e){function n(e){return"br"===Je(e)}var t,r=0===(t=z(e,(function(e){var t=an(e);return L(t,(function(e){return n(e)||bn(e)&&0===Et(e).trim().length}))?[]:t.concat(function(e){return No(e).bind((function(t){var r=ln(t).map((function(e){return!!tc(e)||(n=e,!!x(["br","img","hr","input"],za.property().name(n))&&"img"!==Je(e));var n})).getOr(!1);return on(t).map((function(o){return!0===r||"li"===Je(u=o)||Dn(u,rc).isSome()||n(t)||tc(o)&&!le(e,o)?[]:[qe.fromTag("br")];var u}))})).getOr([])}(e))}))).length?[qe.fromTag("br")]:t;Bt(e[0]),It(e[0],r)}function uc(e){return Au(e,!0)}function ic(e){0===nt(e).length&&Yt(e)}function cc(e,n){return{grid:e,cursor:n}}function lc(e,n,t){var r,o,u,i,c,l=(r=n,o=t,c=gt(e).rows,U.from(null===(i=null===(u=c[r])||void 0===u?void 0:u.cells[o])||void 0===i?void 0:i.element).filter(uc).orThunk((function(){return V(c,(function(e){return V(e.cells,(function(e){var n=e.element;return jn(uc(n),n)}))}))})));return cc(e,l)}function ac(e){return M(e,(function(e,n){return R(e,(function(e){return e.row===n.row}))?e:e.concat([n])}),[]).sort((function(e,n){return e.row-n.row}))}function fc(e,n){return function(t,r,o,u,i){return lc(function(e,n,t,r,o,u,i){var l=gt(e),a=l.cols,f=l.rows,s=f[n[0]],m=z(n,(function(e){return r=o,z((n=f)[t=e].cells,(function(e,o){return Ui(n,t,o,r)?[]:[e]}));var n,t,r})),d=O(s.cells,(function(e,n){return si(Xi(f,n,o))})),g=Y([],f,!0);A(n,(function(e){g[e]=i.transformRow(f[e],t)}));var p,b,h,v,w=a.concat(g),y=(p=s,L(b=d,c)&&si(p.cells)?C:function(e,n,t){return!("th"===Je(e.element)&&b[t])}),S=(h=r,v=d,function(e,n,t){return U.some(Gi(h,e.element,"col",v[t]))});return Ki(w,m,o,u,i.transformCell,S,y)}(t,O(ac(r),(function(e){return e.row})),e,n,o,u.replaceOrInit,i),r[0].row,r[0].column)}}function sc(e,n,t){var r,o=(r=t.section,ut(e,(function(){return r})));return Si($t.generate(o),n,!0)}function mc(e,n,t,r){var o=r.sizing,u=$t.generate(n);ru(u,o.getWidths(u,o),o)}function dc(e,n,t,r){var o=t,u=r.sizing,i=r.resize,c=$t.generate(n),l=u.getWidths(c,u),a=u.pixelWidth(),f=i.calcRedestributedWidths(l,a,o.pixelDelta,u.isRelative),s=f.newSizes,m=f.delta;ru(c,s,u),u.adjustTableWidth(m)}function gc(e,n){return R(n,(function(e){return 0===e.column&&e.isLocked}))}function pc(e,n){return R(n,(function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked}))}function bc(e,n){var t=wr(e);return M(Qi(n),(function(e,n){return e+t[n.column].map(vr).getOr(0)}),0)}function hc(e){return function(n,t){return Ai(n,t).filter((function(t){return!(e?gc:pc)(n,t)})).map((function(e){return{details:e,pixelDelta:bc(n,e)}}))}}function vc(e){return function(n,t){return Oi(n,t).filter((function(t){return!(e?gc:pc)(n,t.cells)}))}}function wc(e,n){var t=$t.fromTable(e);return Ai(t,n).bind((function(e){var n=e[e.length-1],r=e[0].column,o=n.column+n.colspan,u=N(O(t.all,(function(e){return I(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return Da(u)})).getOr("")}function yc(e,n){return Ai($t.fromTable(e),n).bind(Da).getOr("")}function Cc(e,n,t,r){return D(e,(function(e){return function(e,n,t,r){for(var o=qe.fromTag("tr"),u=0;u<e;u++){var i=r<n||u<t?qe.fromTag("th"):qe.fromTag("td");u<t&&Mn(i,"scope","row"),r<n&&Mn(i,"scope","col"),Xt(i,qe.fromTag("br")),Xt(o,i)}return o}(n,t,r,e)}))}function Sc(e,n){e.selection.select(n.dom,!0),e.selection.collapse(!0)}function Tc(e,n,t,r,o){var u=qu(e),i={styles:u,attributes:Vu(e),colGroups:e.getParam("table_use_colgroups",!1,"boolean")};return e.undoManager.ignore((function(){var u=function(e,n,t,r,o,u){void 0===u&&(u=ff);var i,c,l=qe.fromTag("table"),a="cells"!==o;qn(l,u.styles),En(l,u.attributes),u.colGroups&&Xt(l,(i=n,c=qe.fromTag("colgroup"),D(i,(function(){return Xt(c,qe.fromTag("col"))})),c));var f,s=Math.min(e,t);a&&0<t&&(f=qe.fromTag("thead"),Xt(l,f),It(f,Cc(t,n,"sectionCells"===o?s:0,r)));var m=qe.fromTag("tbody");return Xt(l,m),It(m,Cc(a?e-s:e,n,a?0:t,r)),l}(t,n,o,r,Qu(e),i);Mn(u,"data-mce-id","__mce");var c,l,a,f=(c=u,l=qe.fromTag("div"),a=qe.fromDom(c.dom.cloneNode(!0)),Xt(l,a),l.dom.innerHTML);e.insertContent(f),e.addVisual()})),kn(Uo(e),'table[data-mce-id="__mce"]').map((function(n){var t,r,o;return ba(e)?wa(n):ha(e)?ya(n):(Ju(e)||(t=u.width,a(t)&&-1!==t.indexOf("%")))&&va(n),Yo(n),Wt(n,"data-mce-id"),r=e,A(gn(n,"tr"),(function(e){zu(r,e.dom),A(gn(e,"th,td"),(function(e){Lu(r,e.dom)}))})),o=e,kn(n,"td,th").each(h(Sc,o)),n.dom})).getOr(null)}function xc(e,n,t,r,o){function u(e){return b(e)&&0<e}if(void 0===r&&(r={}),u(n)&&u(t)){var i=r.headerRows||0;return Tc(e,t,n,r.headerColumns||0,i)}return console.error(o),null}function Rc(e){return function(){return e().fold((function(){return[]}),(function(e){return O(e,(function(e){return e.dom}))}))}}function Dc(e){return function(n){var t=0<n.length?U.some(qo(n)):U.none();e(t)}}function Oc(e,n,t){var r=Kn(e,n,1);1===t||r<=1?Wt(e,n):Mn(e,n,Math.min(t,r))}function Ac(e,n,t){return function(n,r){for(var o=0;o<r.length;o++){var u=e.getStyle(r[o],t);if((n=void 0===n?u:n)!==u)return""}return n}(void 0,e.select("td,th",n))}function kc(e,n,t){t&&e.formatter.apply("align"+t,{},n)}function Ic(e,n){sf.each("left center right".split(" "),(function(t){e.formatter.remove("align"+t,{},n)}))}function Bc(e){return df.test(t=e)||gf.test(t)?U.some({value:(ke(n=e,"#")?n.substring("#".length):n).toUpperCase()}):U.none();var n,t}function Mc(e){var n=e.toString(16);return(1===n.length?"0"+n:n).toUpperCase()}function Ec(e){return{value:Mc(e.red)+Mc(e.green)+Mc(e.blue)}}function Pc(e,n,t,r){return{red:e,green:n,blue:t,alpha:r}}function Nc(e,n,t,r){return Pc(parseInt(e,10),parseInt(n,10),parseInt(t,10),parseFloat(r))}function zc(e){var n=e;return{get:function(){return n},set:function(e){n=e}}}function Lc(e){function n(){return t.get().each(e)}var t=zc(U.none());return{clear:function(){n(),t.set(U.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(U.some(e))}}}function _c(){var e=Lc(u);return X(X({},e),{on:function(n){return e.get().each(n)}})}function Wc(e){return he(e,"menu")}function jc(e,n){return function(t){var r;e.execCommand("mceTableApplyCellStyle",!1,((r={})[n]=t,r))}}function Fc(e,n,t,r,o){return function(u){return u(vf(e,n,t,r,o))}}function Hc(e,n,t){var r=O(n,(function(e){return{text:e.title,value:"#"+Bc(n=e.value).orThunk((function(){return function(e){if("transparent"===e)return U.some(Pc(0,0,0,0));var n=pf.exec(e);if(null!==n)return U.some(Nc(n[1],n[2],n[3],"1"));var t=bf.exec(e);return null!==t?U.some(Nc(t[1],t[2],t[3],t[4])):U.none()}(n).map(Ec)})).getOrThunk((function(){var e=document.createElement("canvas");e.height=1,e.width=1;var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=n,t.fillRect(0,0,1,1);var r=t.getImageData(0,0,1,1).data;return Ec(Pc(r[0],r[1],r[2],r[3]))})).value,type:"choiceitem"};var n}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<r.length?r:void 0,allowCustomColors:!1},onAction:function(n){var r,o="remove"===n.value?"":n.value;e.execCommand("mceTableApplyCellStyle",!1,((r={})[t]=o,r))}}]}function Vc(e){return function(){var n=e.queryCommandValue("mceTableRowType");e.execCommand("mceTableRowType",!1,{type:"header"===n?"body":"header"})}}function qc(e){return function(){var n=e.queryCommandValue("mceTableColType");e.execCommand("mceTableColType",!1,{type:"th"===n?"td":"th"})}}function Uc(e){return yf.concat((0<(n=hf(Xu(e))).length?U.some({name:"class",type:"listbox",label:"Class",items:n}):U.none()).toArray());var n}function Gc(e,n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(hf(Hu(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}}function $c(e){return function(n,t){var r=n.dom;return{setAttrib:function(n,o){e&&!o||r.setAttrib(t,n,o)},setStyle:function(n,o){e&&!o||r.setStyle(t,n,o)},setFormat:function(r,o){e&&!o||(""===o?n.formatter.remove(r,{value:null},t,!0):n.formatter.apply(r,{value:o},t))}}}}function Kc(e){return function(n){return ke(n,"rgb")?e.toHex(n):n}}function Xc(e,n){var t=qe.fromDom(n);return{borderwidth:Gn(t,"border-width").getOr(""),borderstyle:Gn(t,"border-style").getOr(""),bordercolor:Gn(t,"border-color").map(Kc(e)).getOr(""),backgroundcolor:Gn(t,"background-color").map(Kc(e)).getOr("")}}function Yc(e){var n=e[0];return A(e.slice(1),(function(e){A(Ge(n),(function(t){fe(e,(function(e,r){var o=n[t];""!==o&&t===r&&o!==e&&(n[t]="")}))}))})),n}function Jc(e,n,t,r){return E(e,(function(e){return!g(t.formatter.matchNode(r,n+e))})).getOr("")}function Qc(e,n){var t=$t.fromTable(e);return O(I($t.justCells(t),(function(e){return R(n,(function(n){return le(e.element,n)}))})),(function(e){return{element:e.element.dom,column:$t.getColumnAt(t,e.column).map((function(e){return e.element.dom}))}}))}function Zc(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u=e,i=n,c=t,l=me(r=o,(function(e,n){return c[n]!==e}));0<pe(l)&&1<=i.length&&rt(i[0]).each((function(e){var n,t,o,c=Qc(e,i),a=0<pe(me(l,(function(e,n){return"scope"!==n&&"celltype"!==n}))),f=Xe(l,"celltype");(a||Xe(l,"scope"))&&(n=u,t=r,o=1===c.length,A(c,(function(e){var r,u,i,c,l,a,f=e.element,s=o?Cf.normal(n,f):Cf.ifTruthy(n,f),m=e.column.map((function(e){return o?Cf.normal(n,e):Cf.ifTruthy(n,e)})).getOr(s),d=t;(r=s).setAttrib("scope",d.scope),r.setAttrib("class",d.class),r.setStyle("height",Xo(d.height)),m.setStyle("width",Xo(d.width)),Uu(n)&&((u=s).setFormat("tablecellbackgroundcolor",(i=t).backgroundcolor),u.setFormat("tablecellbordercolor",i.bordercolor),u.setFormat("tablecellborderstyle",i.borderstyle),u.setFormat("tablecellborderwidth",Xo(i.borderwidth))),o&&(Ic(n,f),c=n,l=f,sf.each("top middle bottom".split(" "),(function(e){c.formatter.remove("valign"+e,{},l)}))),t.halign&&kc(n,f,t.halign),!t.valign||(a=t.valign)&&n.formatter.apply("valign"+a,{},f)}))),f&&u.execCommand("mceTableCellType",!1,{type:r.celltype,no_events:!0}),_u(u,e.dom,{structure:f,style:a})})),e.focus()}))}function el(e,n){var t,r,o,u,i,c=Wl(n);0!==c.length&&(r=e,t=Yc(rt((o=c)[0]).map((function(e){return O(Qc(e,o),(function(e){return t=r,o=e.element,u=Uu(r),i=e.column,c=t.dom,l=i.getOr(o),X({width:n(l,"width"),height:n(o,"height"),scope:c.getAttrib(o,"scope"),celltype:o.nodeName.toLowerCase(),class:c.getAttrib(o,"class",""),halign:Sf(t,o),valign:Tf(t,o)},u?Xc(c,o):{});function n(e,n){return c.getStyle(e,n)||c.getAttrib(e,n)}var t,o,u,i,c,l}))})).getOrDie()),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:Uc(e)},Gc(e,"cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:Uc(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Uu(e)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:h(Zc,e,c,t)}))}function nl(e){return xf.concat((0<(n=hf(e.getParam("table_row_class_list",[],"array"))).length?U.some({name:"class",type:"listbox",label:"Class",items:n}):U.none()).toArray());var n}function tl(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u,i,c,l,a,f,s=e,m=n,d=t,g=me(r=o,(function(e,n){return d[n]!==e}));0<pe(g)&&(u=Xe(g,"type"),(i=!u||1<pe(g))&&(c=s,l=r,a=d,f=1===m.length,A(m,(function(e){var n,t,r,o=f?Cf.normal(c,e):Cf.ifTruthy(c,e),u=l;(n=o).setAttrib("class",u.class),n.setStyle("height",Xo(u.height)),Gu(c)&&((t=o).setStyle("background-color",(r=l).backgroundcolor),t.setStyle("border-color",r.bordercolor),t.setStyle("border-style",r.borderstyle)),l.align!==a.align&&(Ic(c,e),kc(c,e,l.align))}))),u&&s.execCommand("mceTableRowType",!1,{type:r.type,no_events:!0}),rt(qe.fromDom(m[0])).each((function(e){return _u(s,e.dom,{structure:u,style:i})}))),e.focus()}))}function rl(e){var n,t,r,o,u,i,c,l=(n=Jo(e),t=zl.selected,o=(r=_l(n)).bind((function(e){return rt(e)})).map(ot),Wn(r,o,(function(e,n){return I(n,(function(n){return R(qo(n.dom.cells),(function(n){return"1"===Pn(n,t)||le(n,e)}))}))})).getOr([]));0!==l.length&&(u=Yc(O(l,(function(n){return t=e,r=n.dom,o=Gu(e),i=t.dom,X({height:i.getStyle(r,"height")||i.getAttrib(r,"height"),class:i.getAttrib(r,"class",""),type:rt(qe.fromDom(u=r)).map((function(e){var n={selection:qo(u.cells)};return af(e,n)})).getOr(""),align:Sf(t,r)},o?Xc(i,r):{});var t,r,o,u,i}))),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:nl(e)},Gc(e,"row")]},c={type:"panel",items:[{type:"grid",columns:2,items:nl(e)}]},e.windowManager.open({title:"Row Properties",size:"normal",body:Gu(e)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onSubmit:h(tl,e,O(l,(function(e){return e.dom})),u)}))}function ol(e,n,t,r){var o=e.dom,u=r.getData(),i=me(u,(function(e,n){return t[n]!==e}));r.close(),""===u.class&&delete u.class,e.undoManager.transact((function(){var t,r,c,l,a;n||(t=parseInt(u.cols,10)||1,r=parseInt(u.rows,10)||1,n=Tc(e,t,r,0,0)),0<pe(i)&&(function(e,n,t){var r,o=e.dom,u={},i={};if(u.class=t.class,i.height=Xo(t.height),o.getAttrib(n,"width")&&!Ku(e)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=Xo(t.width),Ku(e)?(i["border-width"]=Xo(t.border),i["border-spacing"]=Xo(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),Ku(e)&&n.children)for(var c=0;c<n.children.length;c++)Rf(o,n.children[c],{"border-width":Xo(t.border),padding:Xo(t.cellpadding)}),$u(e)&&Rf(o,n.children[c],{"border-color":t.bordercolor});$u(e)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(X(X({},qu(e)),i)),o.setAttribs(n,X(X({},Vu(e)),u))}(e,n,u),((c=o.select("caption",n)[0])&&!u.caption||!c&&u.caption)&&e.execCommand("mceTableToggleCaption"),""===u.align?Ic(e,n):kc(e,n,u.align)),e.focus(),e.addVisual(),0<pe(i)&&(a=!(l=Xe(i,"caption"))||1<pe(i),_u(e,n,{structure:l,style:a}))}))}function ul(e,n){var t,r,o,u,i,c,l,a,f,s,m,d,g,p,b,v,w,y,C,S=e.dom,T=(o=$u(r=e),a=qu(r),f=Vu(r),s=o?(u=r.dom,{borderstyle:be(a,"border-style").getOr(""),bordercolor:Kc(u)(be(a,"border-color").getOr("")),backgroundcolor:Kc(u)(be(a,"background-color").getOr(""))}):{},X(X(X(X(X(X({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),f),s),(l=a["border-width"],Ku(r)&&l?{border:l}:be(f,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(i=be(a,"border-spacing").or(be(f,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),c=be(a,"border-padding").or(be(f,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),X(X({},i),c))));!1===n?(t=S.getParent(e.selection.getStart(),"table",e.getBody()))?(d=t,g=$u(m=e),w=m.dom,y=Ku(m)?w.getStyle(d,"border-spacing")||w.getAttrib(d,"cellspacing"):w.getAttrib(d,"cellspacing")||w.getStyle(d,"border-spacing"),C=Ku(m)?Ac(w,d,"padding")||w.getAttrib(d,"cellpadding"):w.getAttrib(d,"cellpadding")||Ac(w,d,"padding"),T=X({width:w.getStyle(d,"width")||w.getAttrib(d,"width"),height:w.getStyle(d,"height")||w.getAttrib(d,"height"),cellspacing:y,cellpadding:C,border:(p=w,v=Gn(qe.fromDom(b=d),"border-width"),Ku(m)&&v.isSome()?v.getOr(""):p.getAttrib(b,"border")||Ac(m.dom,b,"border-width")||Ac(m.dom,b,"border")),caption:!!w.select("caption",d)[0],class:w.getAttrib(d,"class",""),align:Sf(m,d)},g?Xc(w,d):{})):$u(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""):(T.cols="1",T.rows="1",$u(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""));var x=hf(Yu(e));0<x.length&&T.class&&(T.class=T.class.replace(/\s*mce\-item\-table\s*/g,""));var R,D,O,A,k={type:"grid",columns:2,items:(R=x,D=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],O=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],A=0<R.length?[{type:"listbox",name:"class",label:"Class",items:R}]:[],D.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(O).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(A))},I=$u(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[k]},Gc(e,"table")]}:{type:"panel",items:[k]};e.windowManager.open({title:"Table Properties",size:"normal",body:I,onSubmit:h(ol,e,t,T),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:T})}function il(e){return Ll(Jo(e),Ko(e))}function cl(e,n,t,r,o){function i(e){return rt(e,b)}function c(n){return _l(Jo(t=e),Ko(t)).bind((function(e){return i(e).map((function(t){return n(t,e)}))}));var t}function l(n){e.focus()}function s(e,n){return void 0===n&&(n=!1),c((function(t,o){var u=Zo(r,t,o);e(t,u,n).each(l)}))}function m(){return c((function(n,t){var o,i,c,l=Zo(r,n,t),a=Ho(u,qe.fromDom(e.getDoc()),U.none());return o=l,i=a,Ai(c=$t.fromTable(n),o).bind((function(e){var n=Ti(z(gt(Si(c,i,!1)).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),(function(e){var n=I(e.cells,(function(e){return!e.isLocked}));return 0<n.length?[X(X({},e),{cells:n})]:[]})));return jn(0<n.length,n)})).map((function(e){return O(e,(function(e){var n=lr(e.element);return A(e.cells,(function(e){var t=ar(e.element);vi(t,"colspan",e.colspan,1),vi(t,"rowspan",e.rowspan,1),Xt(n,t)})),n}))}))}))}function d(){return c((function(e,n){var t,o;return t=Zo(r,e,n),ki(o=$t.fromTable(e),t).map((function(e){var n,t,r=e[e.length-1],u=e[0].column,i=r.column+r.colspan,c=function(e,n,t){if($t.hasColumns(e)){var r=O(I($t.justColumns(e),(function(e){return e.column>=n&&e.column<t})),(function(e){var r=ar(e.element);return Oc(r,"span",t-n),r})),o=qe.fromTag("colgroup");return It(o,r),[o]}return[]}(o,u,i),l=(n=u,t=i,O(o.all,(function(e){var r=O(I(e.cells,(function(e){return e.column>=n&&e.column<t})),(function(e){var r=ar(e.element);return Oc(r,"colspan",t-n),r})),o=qe.fromTag("tr");return It(o,r),o})));return Y(Y([],c,!0),l,!0)}))}))}function g(n,t){return t().each((function(t){var o=O(t,ar);c((function(t,u){var i,c,a=Vo(qe.fromDom(e.getDoc())),f=(i=o,c=a,{selection:Qo(r),clipboard:i,generators:c});n(t,f).each(l)}))}))}function p(e){return function(n,t){return be(t,"type").each((function(n){s(e(n),t.no_events)}))}}var b=Ko(e);fe({mceTableSplitCells:function(){return s(n.unmergeCells)},mceTableMergeCells:function(){return s(n.mergeCells)},mceTableInsertRowBefore:function(){return s(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(n.insertRowsAfter)},mceTableInsertColBefore:function(){return s(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(n.insertColumnsAfter)},mceTableDeleteCol:function(){return s(n.deleteColumn)},mceTableDeleteRow:function(){return s(n.deleteRow)},mceTableCutCol:function(){return d().each((function(e){o.setColumns(e),s(n.deleteColumn)}))},mceTableCutRow:function(){return m().each((function(e){o.setRows(e),s(n.deleteRow)}))},mceTableCopyCol:function(){return d().each((function(e){return o.setColumns(e)}))},mceTableCopyRow:function(){return m().each((function(e){return o.setRows(e)}))},mceTablePasteColBefore:function(){return g(n.pasteColsBefore,o.getColumns)},mceTablePasteColAfter:function(){return g(n.pasteColsAfter,o.getColumns)},mceTablePasteRowBefore:function(){return g(n.pasteRowsBefore,o.getRows)},mceTablePasteRowAfter:function(){return g(n.pasteRowsAfter,o.getRows)},mceTableDelete:function(){return il(e).each((function(n){rt(n,b).filter(v(b)).each((function(n){var t,r=qe.fromText("");Dt(n,r),Yt(n),e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):((t=e.dom.createRng()).setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged())}))}))},mceTableCellToggleClass:function(n,t){c((function(n){var o=Wl(r),u=L(o,(function(n){return e.formatter.match("tablecellclass",{value:t},n.dom)}))?e.formatter.remove:e.formatter.apply;A(o,(function(e){return u("tablecellclass",{value:t},e.dom)})),_u(e,n.dom,la)}))},mceTableToggleClass:function(n,t){c((function(n){e.formatter.toggle("tableclass",{value:t},n.dom),_u(e,n.dom,la)}))},mceTableToggleCaption:function(){il(e).each((function(n){rt(n,b).each((function(t){An(t,"caption").fold((function(){var n,r,o=qe.fromTag("caption");Xt(o,qe.fromText("Caption")),r=o,fn(n=t,0).fold((function(){Xt(n,r)}),(function(e){Rt(e,r)})),e.selection.setCursorLocation(o.dom,0)}),(function(r){nn("caption")(n)&&ce("td",t).each((function(n){return e.selection.setCursorLocation(n.dom,0)})),Yt(r)})),_u(e,t.dom,aa)}))}))},mceTableSizingMode:function(n,t){return r=t,il(e).each((function(n){ha(e)||ba(e)||Ju(e)||rt(n,b).each((function(n){"relative"!==r||vl(n)?"fixed"!==r||wl(n)?"responsive"!==r||yl(n)||ya(n):wa(n):va(n),Yo(n),_u(e,n.dom,aa)}))}));var r},mceTableCellType:p((function(e){return"th"===e?n.makeCellsHeader:n.unmakeCellsHeader})),mceTableColType:p((function(e){return"th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader})),mceTableRowType:p((function(e){switch(e){case"header":return n.makeRowsHeader;case"footer":return n.makeRowsFooter;default:return n.makeRowsBody}}))},(function(n,t){return e.addCommand(t,n)})),fe({mceTableProps:h(ul,e,!1),mceTableRowProps:h(rl,e),mceTableCellProps:h(el,e,r)},(function(n,t){return e.addCommand(t,(function(){return n()}))})),e.addCommand("mceInsertTable",(function(n,t){f(t)&&0<Ge(t).length?xc(e,t.rows,t.columns,t.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):ul(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(n,t){function o(e){return"tablecell"+e.toLowerCase().replace("-","")}var u,c;!f(t)||0!==(u=Wl(r)).length&&(function(e){for(var n in e)if($e.call(e,n))return;return 1}(c=me(t,(function(n,t){return e.formatter.has(o(t))&&a(n)})))||(fe(c,(function(n,t){A(u,(function(r){Cf.normal(e,r.dom).setFormat(o(t),n)}))})),i(u[0]).each((function(n){return _u(e,n.dom,la)}))))}))}function ll(e,n){return rt(e,n).bind((function(n){var t=nt(n);return P(t,(function(n){return le(e,n)})).map((function(e){return{index:e,all:t}}))}))}function al(e,n){var t=e.document.createRange();return t.selectNode(n.dom),t}function fl(e,n){var t=e.document.createRange();return Lf(t,n),t}function sl(e,n,t){var r,o=e.document.createRange(),u=o;return n.fold((function(e){u.setStartBefore(e.dom)}),(function(e,n){u.setStart(e.dom,n)}),(function(e){u.setStartAfter(e.dom)})),r=o,t.fold((function(e){r.setEndBefore(e.dom)}),(function(e,n){r.setEnd(e.dom,n)}),(function(e){r.setEndAfter(e.dom)})),o}function ml(e,n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u}function dl(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function gl(e,n,t){return n(qe.fromDom(t.startContainer),t.startOffset,qe.fromDom(t.endContainer),t.endOffset)}function pl(e,n){var t,r,o,u=(t=e,n.match({domRange:function(e){return{ltr:i(e),rtl:U.none}},relative:function(e,n){return{ltr:J((function(){return sl(t,e,n)})),rtl:J((function(){return U.some(sl(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:J((function(){return ml(t,e,n,r,o)})),rtl:J((function(){return U.some(ml(t,r,o,e,n))}))}}}));return(o=(r=u).ltr()).collapsed?r.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return _f.rtl(qe.fromDom(e.endContainer),e.endOffset,qe.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return gl(0,_f.ltr,o)})):gl(0,_f.ltr,o)}function bl(e,n){return pl(e,n).match({ltr:function(n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u},rtl:function(n,t,r,o){var u=e.document.createRange();return u.setStart(r.dom,o),u.setEnd(n.dom,t),u}})}function hl(e,n){return{parent:i(U.from(e.dom.documentElement).map(qe.fromDom).getOr(e)),view:i(e),origin:i(no(0,0)),isResizable:n}}function vl(e){return bo(e).exists((function(e){return Rl.test(e)}))}function wl(e){return bo(e).exists((function(e){return Dl.test(e)}))}function yl(e){return bo(e).isNone()}function Cl(){return{transformRow:c,transformCell:di}}function Sl(e,n){function t(t){if(Zi(t))return Pa((u={element:t}).element)?e.colgroup(u):e.row(u);var o,u,i=(o=n(t),Ea(o.element)?e.col(o):e.cell(o));return r=U.some({item:t,replacement:i}),i}void 0===n&&(n=ec);var r=U.none();return{getOrInit:function(e,n){return r.fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.replacement:t(e)}))}}}function Tl(e){return function(n){function t(t){var o=n.replace(t,e,"td"===e?{scope:null}:{});return r.push({item:t,sub:o}),o}var r=[];return{replaceOrInit:function(e,n){return Zi(e)||Ea(e)?e:(o=e,u=n,E(r,(function(e){return u(e.item,o)})).fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.sub:t(e)})));var o,u}}}}function xl(e){return{unmerge:function(n){var t=nc(n);return t.each((function(e){return Mn(n,"scope",e)})),function(){var r=e.cell({element:n,colspan:1,rowspan:1});return $n(r,"width"),$n(n,"width"),t.each((function(e){return Mn(r,"scope",e)})),r}},merge:function(e){return $n(e[0],"width"),function(){var n=_n(O(e,nc));if(0===n.length)return U.none();var t=n[0],r=["row","col"];return R(n,(function(e){return e!==t&&x(r,e)}))?U.none():U.from(t)}().fold((function(){return Wt(e[0],"scope")}),(function(n){return Mn(e[0],"scope",n+"group")})),i(e[0])}}}var Rl=/(\d+(\.\d+)?)%/,Dl=/(\d+(\.\d+)?)px|em/,Ol=nn("col"),Al=i(Rl),kl=nn("col"),Il=function(e){return bo(e).fold((function(){return{width:t=ko(n=e,hr),pixelWidth:t,getWidths:function(e,t){return Oo(e,n,t)},getCellDelta:r=i(0),singleColumnWidth:i([0]),minCellWidth:r,setElementWidth:u,adjustTableWidth:u,isRelative:!0,label:"none"};var n,t,r}),(function(n){return t=e,r=n,(null!==Al().exec(r)?Io:Bo)(t);var t,r}))},Bl=Bo,Ml=Io,El=["img","br"],Pl=function(e,n){return function e(t){for(var r=an(t),o=r.length-1;0<=o;o--){var u=r[o];if(n(u))return U.some(u);var i=e(u);if(i.isSome())return i}return U.none()}(e)},Nl={scope:["row","col"]},zl={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Ll=eu("th,td,caption"),_l=eu("th,td"),Wl=Qo,jl=zr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Fl=X({},jl),Hl=cu((function(e){return e<0})),Vl=cu(C),ql=zr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Ul=X(X({},ql),{from:function(e){return ne(e,"%")?fu("%",ql.percent,e):ne(e,"px")?fu("px",ql.pixels,e):ql.invalid(e)}}),Gl=function(e){if(0===e.length)return e;var n,t,r=B(e,(function(e,n){var t=Ul.from(n).fold((function(){return{value:n,remainder:0}}),(function(e){return n=e,{value:(t=Math.floor(n))+"px",remainder:n-t};var n,t}),(function(e){return{value:e+"%",remainder:0}}));return{output:[t.value].concat(e.output),remainder:e.remainder+t.remainder}}),{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(n=o[o.length-1],t=Math.round(r.remainder),Ul.from(n).fold(i(n),(function(e){return e+t+"px"}),(function(e){return e+t+"%"})))])},$l=Ul.from,Kl=yu(["compare","extract","mutate","sink"]),Xl=yu(["element","start","stop","destroy"]),Yl=yu(["forceDrop","drop","move","delayDrop"]),Jl=function(e,n,t,r){e.dom.removeEventListener(n,t,r)},Ql=C,Zl=Cu,ea=Du("ephox-dragster").resolve,na=Kl({compare:function(e,n){return no(n.left-e.left,n.top-e.top)},extract:function(e){return U.some(no(e.x,e.y))},sink:function(e,n){var t,r,o,u=(t=n,r=X({layerClass:ea("blocker")},t),Mn(o=qe.fromTag("div"),"role","presentation"),qn(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),xu(o,ea("blocker")),xu(o,r.layerClass),{element:i(o),destroy:function(){Yt(o)}}),c=Su(u.element(),"mousedown",e.forceDrop),l=Su(u.element(),"mouseup",e.drop),a=Su(u.element(),"mousemove",e.move),f=Su(u.element(),"mouseout",e.delayDrop);return Xl({element:u.element,start:function(e){Xt(e,u.element())},stop:function(){Yt(u.element())},destroy:function(){u.destroy(),l.unbind(),a.unbind(),f.unbind(),c.unbind()}})},mutate:function(e,n){e.mutate(n.left,n.top)}}),ta=function(e){return e.dom.contentEditable},ra=Du("ephox-snooker").resolve,oa=ra("resizer-bar"),ua=ra("resizer-rows"),ia=ra("resizer-cols"),ca=ra("resizer-bar-dragging"),la={structure:!1,style:!0},aa={structure:!0,style:!1},fa={structure:!0,style:!0},sa={"border-collapse":"collapse",width:"100%"},ma=D(5,(function(e){var n=e+1+"px";return{title:n,value:n}})),da=O(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),ga={border:"1"},pa="preservetable",ba=function(e){return"fixed"===Wu(e)||!1===ju(e)},ha=function(e){return"responsive"===Wu(e)},va=function(e){var n=Co(e);gu(e,U.some(n),U.none()),ii(e)},wa=function(e){var n=hr(e)+"px";gu(e,U.some(n),U.none()),ii(e)},ya=function(e){$n(e,"width");var n=tt(e);A(0<n.length?n:nt(e),(function(e){$n(e,"width"),ii(e)})),ii(e)},Ca="bar-",Sa=function e(n,t,r){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?r(t).bind((function(t){return e(n,t,r).orThunk((function(){return U.some(t)}))})):U.none()},Ta=function e(n,t){var r=Sa(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(r))return li(r,ai(n,r));var o=n.property().children(r);return 0<o.length?e(n,o[o.length-1]):li(r,ai(n,r))},xa=Zt(),Ra=nn("th"),Da=function(e){var n=I(e,(function(e){return Ra(e.element)}));return 0===n.length?U.some("td"):n.length===e.length?U.some("th"):U.none()},Oa=pi,Aa=bi,ka=hi,Ia=function e(n){return{isValue:C,isError:y,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:function(t){return e(n)},orThunk:function(t){return e(n)},fold:function(e,t){return t(n)},map:function(t){return e(t(n))},mapError:function(t){return e(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return U.some(n)}}},Ba=function e(n){return{isValue:y,isError:C,getOr:c,getOrThunk:function(e){return e()},getOrDie:function(){return e=String(n),function(){throw new Error(e)}();var e},or:c,orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(t){return e(n)},mapError:function(t){return e(t(n))},each:u,bind:function(t){return e(n)},exists:y,forall:C,toOptional:U.none}},Ma={value:Ia,error:Ba,fromOption:function(e,n){return e.fold((function(){return Ba(n)}),Ia)}},Ea=nn("col"),Pa=nn("colgroup"),Na=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],za=Zt(),La=fc("thead",!0),_a=fc("tbody",!1),Wa=fc("tfoot",!1),ja=Tl("th"),Fa=Tl("td"),Ha=Di((function(e,n,t,r){var o=n[0].row;return lc(B(ac(n),(function(e,n){return{grid:Vi(e.grid,o,n.row+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o,n[0].column)}),Ai,u,u,Sl),Va=Di((function(e,n,t,r){var o=ac(n),u=o[o.length-1],i=u.row+u.rowspan;return lc(B(o,(function(e,n){return Vi(e,i,n.row,t,r.getOrInit)}),e),i,n[0].column)}),Ai,u,u,Sl),qa=Di((function(e,n,t,r){var o=n.details,u=Qi(o),i=u[0].column;return lc(B(u,(function(e,n){return{grid:qi(e.grid,i,n.column+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o[0].row,i)}),hc(!0),dc,u,Sl),Ua=Di((function(e,n,t,r){var o=n.details,u=o[o.length-1],i=u.column+u.colspan;return lc(B(Qi(o),(function(e,n){return qi(e,i,n.column,t,r.getOrInit)}),e),o[0].row,i)}),hc(!1),dc,u,Sl),Ga=Di((function(e,n,t,r){var o,u,i=Qi(n.details),c=(o=e,u=O(i,(function(e){return e.column})),z(o,(function(e){var n=e.cells,t=B(u,(function(e,n){return 0<=n&&n<e.length?e.slice(0,n).concat(e.slice(n+1)):e}),n);return 0<t.length?[Ce(e.element,t,e.section,e.isNew)]:[]}))),l=0<c.length?c[0].cells.length-1:0;return lc(c,i[0].row,Math.min(i[0].column,l))}),(function(e,n){return ki(e,n).map((function(n){return{details:n,pixelDelta:-bc(e,n)}}))}),dc,ic,Sl),$a=Di((function(e,n,t,r){var o,u,i,c,l=ac(n),a=(o=l[0].row,u=l[l.length-1].row,c=(i=gt(e)).rows,i.cols.concat(c.slice(0,o)).concat(c.slice(u+1))),f=0<a.length?a.length-1:0;return lc(a,Math.min(n[0].row,f),n[0].column)}),Ai,u,ic,Sl),Ka=Di((function(e,n,t,r){return lc(Yi(e,O(Qi(n),(function(e){return e.column})),!0,t,r.replaceOrInit),n[0].row,n[0].column)}),ki,u,u,ja),Xa=Di((function(e,n,t,r){return lc(Yi(e,O(Qi(n),(function(e){return e.column})),!1,t,r.replaceOrInit),n[0].row,n[0].column)}),ki,u,u,Fa),Ya=Di(La,ki,u,u,ja),Ja=Di(_a,ki,u,u,Fa),Qa=Di(Wa,ki,u,u,Fa),Za=Di((function(e,n,t,r){return lc(Ji(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),ki,u,u,ja),ef=Di((function(e,n,t,r){return lc(Ji(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),ki,u,u,Fa),nf=Di((function(e,n,t,r){var o=n.cells;return oc(o),cc(function(e,n,t){var r=gt(e).rows;if(0===r.length)return e;for(var o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++){var i=r[o],c=st(i,u).isLocked;ft(i,u,ye(t(),!1,c))}return e}(e,n.bounds,r.merge(o)),U.from(o[0]))}),Bi,mc,u,xl),tf=Di((function(e,n,t,r){return cc(B(n,(function(e,n){return Ei(e,n,t,r.unmerge(n))}),e),U.from(n[0]))}),Mi,mc,u,xl),rf=Di((function(e,n,t,r){var o,u,i=(o=n.clipboard,u=n.generators,Si($t.fromTable(o),u,!0));return function(e,n,t,r,o){var u,i,c,l=ht(n),a=(u=e,i=l,c=dt(n[0]),{row:gt(n).cols.length+u.row,column:E(D(c-u.column,(function(e){return e+u.column})),(function(e){return L(i,(function(n){return n!==e}))})).getOr(c-1)}),f=gt(t).rows,s=ji(a,f,l);return function(e,n,t){if(e.row>=n.length||e.column>dt(n[0]))return Ma.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=n.slice(e.row),o=r[0].cells.slice(e.column),u=dt(t[0]),i=t.length;return Ma.value({rowDelta:r.length-i,colDelta:o.length-u})}(a,n,f).map((function(e){var t=X(X({},e),{colDelta:e.colDelta-s.length}),u=Wi(n,t,r),i=ht(u),c=ji(a,f,i);return function(e,n,t,r,o,u){for(var i,c,l,a,f,s=e.row,m=e.column,d=s+t.length,g=m+dt(t[0])+u.length,p=_(u,C),b=s;b<d;b++)for(var v,w,y,S=0,T=m;T<g;T++)p[T]?S++:(l=T,a=void 0,a=h(o,st((i=n)[c=b],l).element),f=i[c],1<i.length&&1<dt(f)&&(0<l&&a(mt(f,l-1))||l<f.cells.length-1&&a(mt(f,l+1))||0<c&&a(mt(i[c-1],l))||c<i.length-1&&a(mt(i[c+1],l)))&&Ei(n,mt(n[b],T),o,r.cell),w=(v=st(t[b-s],T-m-S)).element,y=r.replace(w),ft(n[b],T,ye(y,!0,v.isLocked)));return n}(a,u,f,r,o,c)}))}({row:n.row,column:n.column},e,i,n.generators,t).fold((function(){return cc(e,U.some(n.element))}),(function(e){return lc(e,n.row,n.column)}))}),(function(e,n){return et(n.element).bind((function(t){return xi(e,t).map((function(e){return X(X({},e),{generators:n.generators,clipboard:n.clipboard})}))}))}),mc,u,Sl),of=Di((function(e,n,t,r){var o=gt(e).rows,u=n.cells[0].column,i=o[n.cells[0].row];return lc(Fi(u,e,sc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),vc(!0),u,u,Sl),uf=Di((function(e,n,t,r){var o=gt(e).rows,u=n.cells[n.cells.length-1].column+n.cells[n.cells.length-1].colspan,i=o[n.cells[0].row];return lc(Fi(u,e,sc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),vc(!1),u,u,Sl),cf=Di((function(e,n,t,r){var o=gt(e).rows,u=n.cells[0].row,i=o[u];return lc(Hi(u,e,sc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Oi,u,u,Sl),lf=Di((function(e,n,t,r){var o=gt(e).rows,u=n.cells[n.cells.length-1].row+n.cells[n.cells.length-1].rowspan,i=o[n.cells[0].row];return lc(Hi(u,e,sc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),Oi,u,u,Sl),af=function(e,n){var t=$t.fromTable(e);return Ai(t,n).bind((function(e){var n=e[e.length-1],r=e[0].row,o=n.row+n.rowspan;return function(){var e=O(t.all.slice(r,o),(function(e){return mi(e).type})),n=x(e,"header"),u=x(e,"footer");if(n||u){var i=x(e,"body");return!n||i||u?n||i||!u?U.none():U.some("footer"):U.some("header")}return U.some("body")}()})).getOr("")},ff={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},sf=tinymce.util.Tools.resolve("tinymce.util.Tools"),mf=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],df=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,gf=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,pf=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,bf=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,hf=function e(n){return O(n,(function(n){var t=n.text||n.title;return Wc(n)?{text:t,items:e(n.menu)}:{text:t,value:n.value}}))},vf=function e(n,t,r,o,u){return O(r,(function(r){var i,c,l,a,f=r.text||r.title;return Wc(r)?{type:"nestedmenuitem",text:f,getSubmenuItems:function(){return e(n,t,r.menu,o,u)}}:{text:f,type:"togglemenuitem",onAction:function(){return u(r.value)},onSetup:(i=n,c=t,l=o,a=r.value,function(e){function n(){function n(e){return i.formatter.match(l,{value:a},e.dom,r)}var o=Wl(c);r?(e.setActive(!R(o,n)),t.set(i.formatter.formatChanged(l,(function(n){return e.setActive(!n)}),!0))):(e.setActive(L(o,n)),t.set(i.formatter.formatChanged(l,e.setActive,!1,{value:a})))}var t=Lc((function(e){return e.unbind()})),r=!te(a);return i.initialized?n():i.on("init",n),t.clear})}}))},wf=function e(n){return z(n,(function(n){return Wc(n)?[X(X({},n),{menu:e(n.menu)})]:te(n.value)?[n]:[]}))},yf=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:mf}],Cf={normal:$c(!1),ifTruthy:$c(!0)},Sf=h(Jc,["left","center","right"],"align"),Tf=h(Jc,["top","middle","bottom"],"valign"),xf=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Rf=function e(n,t,r,o){if("TD"===t.tagName||"TH"===t.tagName)a(r)?n.setStyle(t,r,o):n.setStyle(t,r);else if(t.children)for(var u=0;u<t.children.length;u++)e(n,t.children[u],r,o)},Df={remove_similar:!0,inherit:!1},Of=X({selector:"td,th"},Df),Af={tablecellbackgroundcolor:X({styles:{backgroundColor:"%value"}},Of),tablecellverticalalign:X({styles:{"vertical-align":"%value"}},Of),tablecellbordercolor:X({styles:{borderColor:"%value"}},Of),tablecellclass:X({classes:["%value"]},Of),tableclass:X({selector:"table",classes:["%value"]},Df),tablecellborderstyle:X({styles:{borderStyle:"%value"}},Of),tablecellborderwidth:X({styles:{borderWidth:"%value"}},Of)},kf=zr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),If=X(X({},kf),{none:function(e){return kf.none(e=void 0===e?void 0:e)}}),Bf=function e(n,t,r,o,u){void 0===u&&(u=C);var i=1===o;if(!i&&r<=0)return If.first(n[0]);if(i&&r>=n.length-1)return If.last(n[n.length-1]);var c=r+o,l=n[c];return u(l)?If.middle(t,l):e(n,t,c,o,u)},Mf=function(e,n,t,r){return{start:e,soffset:n,finish:t,foffset:r}},Ef=zr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Pf={before:Ef.before,on:Ef.on,after:Ef.after,cata:function(e,n,t,r){return e.fold(n,t,r)},getStart:function(e){return e.fold(c,c,c)}},Nf=zr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),zf={domRange:Nf.domRange,relative:Nf.relative,exact:Nf.exact,exactFromRange:function(e){return Nf.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var n=e.match({domRange:function(e){return qe.fromDom(e.startContainer)},relative:function(e,n){return Pf.getStart(e)},exact:function(e,n,t,r){return e}});return qe.fromDom(rn(n).dom.defaultView)},range:Mf},Lf=function(e,n){return e.selectNodeContents(n.dom)},_f=zr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function Wf(e,n,t){return n>=e.left&&n<=e.right&&t>=e.top&&t<=e.bottom}function jf(e,n){return n-e.left<e.right-n}function Ff(e,n,t){var r=e.dom.createRange();return r.selectNode(n.dom),r.collapse(t),r}function Hf(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var o=jf(r.getBoundingClientRect(),t);return(!0===o?Po:No)(n).map((function(n){return Ff(e,n,o)}))}function Vf(e,n,t){var r=jf(n.dom.getBoundingClientRect(),t);return U.some(Ff(e,n,r))}function qf(e,n){var t=Je(e);return"input"===t?Pf.after(e):x(["br","img"],t)?0===n?Pf.before(e):Pf.after(e):Pf.on(e,n)}function Uf(e,n){var t=e.fold(Pf.before,qf,Pf.after),r=n.fold(Pf.before,qf,Pf.after);return zf.relative(t,r)}function Gf(e,n,t,r){var o=qf(e,n),u=qf(t,r);return zf.relative(o,u)}function $f(e){return U.from(e.getSelection())}function Kf(e,n){$f(e).each((function(e){e.removeAllRanges(),e.addRange(n)}))}function Xf(e,n,t,r,o){Kf(e,ml(e,n,t,r,o))}function Yf(e,n){return pl(e,n).match({ltr:function(n,t,r,o){Xf(e,n,t,r,o)},rtl:function(n,t,r,o){$f(e).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(n.dom,t,r.dom,o);else if(u.extend)try{c=r,l=o,(i=u).collapse(n.dom,t),i.extend(c.dom,l)}catch(u){Xf(e,r,o,n,t)}else Xf(e,r,o,n,t);var i,c,l}))}})}function Jf(e,n,t,r,o){Yf(e,Gf(n,t,r,o))}function Qf(e,n,t){Yf(e,Uf(n,t))}function Zf(e){if(0<e.rangeCount){var n=e.getRangeAt(0),t=e.getRangeAt(e.rangeCount-1);return U.some(Mf(qe.fromDom(n.startContainer),n.startOffset,qe.fromDom(t.endContainer),t.endOffset))}return U.none()}function es(e){if(null===e.anchorNode||null===e.focusNode)return Zf(e);var n,t,r,o,u,i,c,l,a,f,s,m=qe.fromDom(e.anchorNode),d=qe.fromDom(e.focusNode);return n=m,i=t=e.anchorOffset,c=r=d,l=o=e.focusOffset,(a=tn(u=n).dom.createRange()).setStart(u.dom,i),a.setEnd(c.dom,l),f=a,s=le(n,r)&&t===o,f.collapsed&&!s?U.some(Mf(m,e.anchorOffset,d,e.focusOffset)):Zf(e)}function ns(e,n,t){Kf(e,((t=void 0===t||t)?fl:al)(e,n))}function ts(e){return $f(e).filter((function(e){return 0<e.rangeCount})).bind(es).map((function(e){return zf.exact(e.start,e.soffset,e.finish,e.foffset)}))}function rs(e,n,t){return zs(e,n,(o=Au,ll(r=t,void 0).fold((function(){return If.none(r)}),(function(e){return Bf(e.all,r,e.index,1,o)}))));var r,o}function os(e,n){var t=bl(e,n);return Mf(qe.fromDom(t.startContainer),t.startOffset,qe.fromDom(t.endContainer),t.endOffset)}function us(e,n){return{item:e,mode:n}}function is(e,n,t,r){return void 0===r&&(r=Ms),e.property().parent(n).map((function(e){return us(e,r)}))}function cs(e){return function(n){return 0===e.property().children(n).length}}function ls(e,n){return Gs(Ks,e,cs(Ks),n)}function as(e,n){return $s(Ks,e,cs(Ks),n)}function fs(e){return In(e,"tr")}function ss(e){return"br"===Je(e)}function ms(e,n){return{left:e.left,top:e.top+n,right:e.right,bottom:e.bottom+n}}function ds(e,n){return{left:e.left,top:e.top-n,right:e.right,bottom:e.bottom-n}}function gs(e,n,t){return{left:e.left+n,top:e.top+t,right:e.right+n,bottom:e.bottom+t}}function ps(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function bs(e,n){return U.some(e.getRect(n))}function hs(e,n,t){return pn(n)?bs(e,n).map(ps):bn(n)?(r=e,o=n,(0<=(u=t)&&u<Mo(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):U.none()).map(ps)):U.none();var r,o,u}function vs(e,n){return pn(n)?bs(e,n).map(ps):bn(n)?e.getRangedRect(n,0,n,Mo(n)).map(ps):U.none()}function ws(e,n,t){return Rn((function(e,n){return n(e)}),Dn,n,tc,void 0).fold(y,(function(n){return vs(e,n).exists((function(e){return(n=t).left<(r=e).left||Math.abs(r.right-n.left)<1||n.left>r.right;var n,r}))}))}function ys(e,n,t){var r,o=e.move(t,5),u=nm(n,e,t,o,100).getOr(o),i=u,c=n;return((r=e).point(i)>c.getInnerHeight()?U.some(r.point(i)-c.getInnerHeight()):r.point(i)<0?U.some(-r.point(i)):U.none()).fold((function(){return n.situsFromPoint(u.left,e.point(u))}),(function(t){return n.scrollBy(0,t),n.situsFromPoint(u.left,e.point(u)-t)}))}function Cs(e,n,t,r,o){return In(r,"td,th",n).bind((function(r){return In(r,"table",n).bind((function(u){return a=u,Dn(o,(function(e){return on(e).exists((function(e){return le(e,a)}))}),void 0).isSome()?(i=f=e,c=s=n,l=m=t,i.getSelection().bind((function(e){return function(e,n,t,r){var o,u,i,c,l,a,f;return(ss(n)?(o=e,(i=r).traverse(u=n).orThunk((function(){return Qs(u,i.gather,o)})).map(i.relative)):(c=e,l=r,fn(a=n,f=t).filter(ss).orThunk((function(){return fn(a,f-1).filter(ss)})).bind((function(e){return l.traverse(e).fold((function(){return Qs(e,l.gather,c).map(l.relative)}),(function(e){return on(n=e).bind((function(e){var t=an(e);return Js(t,n).map((function(r){return{parent:e,children:t,element:n,index:r}}))})).map((function(e){return Pf.on(e.parent,e.index)}));var n}))})))).map((function(e){return{start:e,finish:e}}))}(c,e.finish,e.foffset,l).fold((function(){return U.some(li(e.finish,e.foffset))}),(function(n){var t=i.fromSitus(n),r=Ys.verify(i,e.finish,e.foffset,t.finish,t.foffset,l.failure,c);return Ys.cata(r,(function(e){return U.none()}),(function(){return U.none()}),(function(e){return U.some(li(e,0))}),(function(e){return U.some(li(e,Mo(e)))}))}))})).bind((function(e){return rm(f,s,e.element,e.offset,m,20).map(f.fromSitus)})).bind((function(e){return In(e.finish,"td,th",n).map((function(n){return{start:r,finish:n,range:e}}))}))):U.none();var i,c,l,a,f,s,m}))}))}function Ss(e,n,t,r,o,u){return Ve().browser.isIE()?U.none():u(r,n).orThunk((function(){return Cs(e,n,t,r,o).map((function(e){var n=e.range;return _s(U.some(js(n.start,n.soffset,n.finish,n.foffset)),!0)}))}))}function Ts(e,n){return In(e,"tr",n).bind((function(e){return In(e,"table",n).bind((function(t){var r=gn(t,"tr");return le(e,r[0])?Gs(Ks,t,(function(e){return No(e).isSome()}),n).map((function(e){var n=Mo(e);return _s(U.some(js(e,n,e,n)),!0)})):U.none()}))}))}function xs(e,n){return In(e,"tr",n).bind((function(e){return In(e,"table",n).bind((function(t){var r=gn(t,"tr");return le(e,r[r.length-1])?$s(Ks,t,(function(e){return Po(e).isSome()}),n).map((function(e){return _s(U.some(js(e,0,e,0)),!0)})):U.none()}))}))}function Rs(e,n,t,r,o,u,i){return Cs(e,t,r,o,u).bind((function(e){return Fs(n,t,e.start,e.finish,i)}))}function Ds(e,n){return In(e,"td,th",n)}function Os(e){return function(n){return n===e}}function As(e){return 37<=e&&e<=40}function ks(e){return{elementFromPoint:function(n,t){return qe.fromPoint(qe.fromDom(e.document),n,t)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(n,t,r,o){var u,i,c,l=zf.exact(n,t,r,o);return 0<(i=0<(c=(u=bl(e,l)).getClientRects()).length?c[0]:u.getBoundingClientRect()).width||0<i.height?U.some(i).map(dl):U.none()},getSelection:function(){return ts(e).map((function(n){return os(e,n)}))},fromSitus:function(n){var t=zf.relative(n.start,n.finish);return os(e,t)},situsFromPoint:function(n,t){return r=n,o=t,u=qe.fromDom(e.document),Ps(u,r,o).map((function(e){return Mf(qe.fromDom(e.startContainer),e.startOffset,qe.fromDom(e.endContainer),e.endOffset)})).map((function(e){return Ws(e.start,e.soffset,e.finish,e.foffset)}));var r,o,u},clearSelection:function(){$f(e).each((function(e){return e.removeAllRanges()}))},collapseSelection:function(n){void 0===n&&(n=!1),ts(e).each((function(t){return t.fold((function(e){return e.collapse(n)}),(function(t,r){var o=n?t:r;Qf(e,o,o)}),(function(t,r,o,u){var i=n?t:o,c=n?r:u;Jf(e,i,c,i,c)}))}))},setSelection:function(n){Jf(e,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,t){Qf(e,n,t)},selectNode:function(n){ns(e,n,!1)},selectContents:function(n){ns(e,n)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n=qe.fromDom(e.document),t=void 0!==n?n.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return no(r,o).top},scrollBy:function(n,t){var r,o=n,u=t,i=qe.fromDom(e.document);(r=(void 0!==i?i.dom:document).defaultView)&&r.scrollBy(o,u)}}}function Is(e,n){return{rows:e,cols:n}}function Bs(e){return!1===Ru(qe.fromDom(e.target),"ephox-snooker-resizer-bar")}function Ms(e,n,t,r){return void 0===r&&(r=Hs),t.sibling(e,n).map((function(e){return us(e,r)}))}_f.ltr,_f.rtl;var Es=function e(n,t,r,o){return bn(t)?(i=t,c=r,l=o,(a=(u=n).dom.createRange()).selectNode(i.dom),V(a.getClientRects(),(function(e){return Wf(e,c,l)?U.some(e):U.none()})).map((function(e){return function(e,n,t,r,o){function u(t){var r=e.dom.createRange();return r.setStart(n.dom,t),r.collapse(!0),r}var i=Et(n).length,c=function(e,n,t,r){if(0===r)return 0;if(e===t)return r-1;for(var o=t,i=1;i<r;i++){var c=u(i).getBoundingClientRect(),l=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||o<l)return i-1;o=l}}return 0}(t,r,o.right,i);return u(c)}(u,i,c,l,e)}))):(s=t,m=r,d=o,g=(f=n).dom.createRange(),V(an(s),(function(n){return g.selectNode(n.dom),Wf(g.getBoundingClientRect(),m,d)?e(f,n,m,d):U.none()})));var u,i,c,l,a,f,s,m,d,g},Ps=document.caretPositionFromPoint?function(e,n,t){var r,o;return U.from(null===(o=(r=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,n,t)).bind((function(n){if(null===n.offsetNode)return U.none();var t=e.dom.createRange();return t.setStart(n.offsetNode,n.offset),t.collapse(),U.some(t)}))}:document.caretRangeFromPoint?function(e,n,t){var r,o;return U.from(null===(o=(r=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,n,t))}:function(e,n,t){return qe.fromPoint(e,n,t).bind((function(r){function o(){return t=e,u=n,(0===an(o=r).length?Vf:Hf)(t,o,u);var t,o,u}return 0===an(r).length?o():function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect();return function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return Es(e,n,i,c)}(e,n,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))}(e,r,n,t).orThunk(o)}))},Ns=tinymce.util.Tools.resolve("tinymce.util.VK"),zs=function(e,n,t){return t.fold(U.none,U.none,(function(e,n){return Po(n).map((function(e){return t=zf.exact(e,0,e,0),r=zf.getWin(t).dom,o=t.match({domRange:function(e){var n=qe.fromDom(e.startContainer),t=qe.fromDom(e.endContainer);return Gf(n,e.startOffset,t,e.endOffset)},relative:Uf,exact:Gf}),pl(r,o).match({ltr:n,rtl:n});function n(e,n,t,o){return ml(r,e,n,t,o)}var t,r,o}))}),(function(t){return e.execCommand("mceTableInsertRowAfter"),rs(e,n,t)}))},Ls=["table","li","dl"],_s=function(e,n){return{selection:e,kill:n}},Ws=function(e,n,t,r){return{start:Pf.on(e,n),finish:Pf.on(t,r)}},js=Ws,Fs=function(e,n,t,r,o){return le(t,r)?U.none():tr(t,r,n).bind((function(n){var r=n.boxes.getOr([]);return 1<r.length?(o(e,r,n.start,n.finish),U.some(_s(U.some(js(t,0,t,Mo(t))),!0))):U.none()}))},Hs=function e(n,t,r,o){void 0===o&&(o=e);var u=n.property().children(t);return r.first(u).map((function(e){return us(e,o)}))},Vs=[{current:is,next:Ms,fallback:U.none()},{current:Ms,next:Hs,fallback:U.some(is)},{current:Hs,next:Hs,fallback:U.some(Ms)}],qs=function e(n,t,r,o,u){return E(u=void 0===u?Vs:u,(function(e){return e.current===r})).bind((function(r){return r.current(n,t,o,r.next).orThunk((function(){return r.fallback.bind((function(r){return e(n,t,r,o)}))}))}))},Us=function e(n,t,r,o,u,i){return qs(n,t,o,u).bind((function(t){return i(t.item)?U.none():r(t.item)?U.some(t.item):e(n,t.item,r,t.mode,u,i)}))},Gs=function(e,n,t,r){return Us(e,n,t,Ms,{sibling:function(e,n){return e.query().prevSibling(n)},first:function(e){return 0<e.length?U.some(e[e.length-1]):U.none()}},r)},$s=function(e,n,t,r){return Us(e,n,t,Ms,{sibling:function(e,n){return e.query().nextSibling(n)},first:function(e){return 0<e.length?U.some(e[0]):U.none()}},r)},Ks=Zt(),Xs=zr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Ys=X(X({},Xs),{verify:function(e,n,t,r,o,u,i){return In(r,"td,th",i).bind((function(t){return In(n,"td,th",i).map((function(n){return le(t,n)?le(r,t)&&Mo(t)===o?u(n):Xs.none("in same cell"):er(fs,[t,n]).fold((function(){return o=t,i=(r=e).getRect(n),(c=r.getRect(o)).right>i.left&&c.left<i.right?Xs.success():u(n);var r,o,i,c}),(function(e){return u(n)}))}))})).getOr(Xs.none("default"))},cata:function(e,n,t,r,o){return e.fold(n,t,r,o)}}),Js=function(e,n){return P(e,h(le,n))},Qs=function e(n,t,r){return t(n,r).bind((function(n){return bn(n)&&0===Et(n).trim().length?e(n,t,r):U.some(n)}))},Zs=zr([{none:[]},{retry:["caret"]}]),em={point:function(e){return e.bottom},adjuster:function(e,n,t,r,o){var u=ms(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Zs.retry(u):t.top===o.bottom?Zs.retry(ms(o,1)):ws(e,n,o)?Zs.retry(gs(u,5,0)):Zs.none()},move:ms,gather:as},nm=function e(n,t,r,o,u){return 0===u?U.some(o):(c=n,l=o.left,a=t.point(o),c.elementFromPoint(l,a).filter((function(e){return"table"===Je(e)})).isSome()?(i=u-1,e(n,t,r,t.move(o,5),i)):n.situsFromPoint(o.left,t.point(o)).bind((function(i){return i.start.fold(U.none,(function(i){return vs(n,i).bind((function(c){return t.adjuster(n,i,c,r,o).fold(U.none,(function(o){return e(n,t,r,o,u-1)}))})).orThunk((function(){return U.some(o)}))}),U.none)})));var i,c,l,a},tm={tryUp:h(ys,{point:function(e){return e.top},adjuster:function(e,n,t,r,o){var u=ds(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Zs.retry(u):t.bottom===o.top?Zs.retry(ds(o,1)):ws(e,n,o)?Zs.retry(gs(u,5,0)):Zs.none()},move:ds,gather:ls}),tryDown:h(ys,em),ieTryUp:function(e,n){return e.situsFromPoint(n.left,n.top-5)},ieTryDown:function(e,n){return e.situsFromPoint(n.left,n.bottom+5)},getJumpSize:i(5)},rm=function e(n,t,r,o,u,i){return 0===i?U.none():im(n,t,r,o,u).bind((function(c){var l=n.fromSitus(c),a=Ys.verify(n,r,o,l.finish,l.foffset,u.failure,t);return Ys.cata(a,(function(){return U.none()}),(function(){return U.some(c)}),(function(c){return le(r,c)&&0===o?om(n,r,o,ds,u):e(n,t,c,0,u,i-1)}),(function(c){return le(r,c)&&o===Mo(c)?om(n,r,o,ms,u):e(n,t,c,Mo(c),u,i-1)}))}))},om=function(e,n,t,r,o){return hs(e,n,t).bind((function(n){return um(e,o,r(n,tm.getJumpSize()))}))},um=function(e,n,t){var r=Ve().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(e,t):r.isIE()?n.ieRetry(e,t):U.none()},im=function(e,n,t,r,o){return hs(e,t,r).bind((function(n){return um(e,o,n)}))},cm={traverse:ln,gather:as,relative:Pf.before,otherRetry:tm.tryDown,ieRetry:tm.ieTryDown,failure:Ys.failedDown},lm={traverse:cn,gather:ls,relative:Pf.before,otherRetry:tm.tryUp,ieRetry:tm.ieTryUp,failure:Ys.failedUp},am=Os(38),fm=Os(40),sm={isBackward:Os(37),isForward:Os(39)},mm={isBackward:Os(39),isForward:Os(37)},dm=tinymce.util.Tools.resolve("tinymce.Env");function gm(e,n,t){var r=function(e,n,t){function r(n){Wt(n,e.selected),Wt(n,e.firstSelected),Wt(n,e.lastSelected)}function o(n){Mn(n,e.selected,"1")}function u(e){i(e),t()}function i(n){A(gn(n,e.selectedSelector+","+e.firstSelectedSelector+","+e.lastSelectedSelector),r)}return{clearBeforeUpdate:i,clear:u,selectRange:function(t,r,i,c){u(t),A(r,o),Mn(i,e.firstSelected,"1"),Mn(c,e.lastSelected,"1"),n(r,i,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}(zl,(function(n,r,o){t.targets().each((function(t){rt(r).each((function(i){var c,l,a,f=ti(e),s=Ho(u,qe.fromDom(e.getDoc()),f),m=(c=t,l=s,Ai(a=$t.fromTable(i),c).map((function(e){var n,t,r=Si(a,l,!1);return{upOrLeftCells:z(Ti(r.slice(0,(n=e)[n.length-1].row+1)),(function(e){return O(e.cells.slice(0,n[n.length-1].column+1),(function(e){return e.element}))})),downOrRightCells:z(Ti(r.slice((t=e)[0].row+t[0].rowspan-1,r.length)),(function(e){return O(e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length),(function(e){return e.element}))}))}})));e.fire("TableSelectionChange",{cells:n,start:r,finish:o,otherCells:m})}))}))}),(function(){e.fire("TableSelectionClear")}));return e.on("init",(function(t){var o,i,c,l,a,f,s,m,d,g,p,b,v,w,y,C,S=e.getWin(),T=Uo(e),x=Ko(e),R=(o=ks(S),{clearstate:(p=o,b=T,v=x,w=r,y=_c(),(i={clearstate:C=y.clear,mousedown:function(e){w.clear(b),Ds(e.target,v).each(y.set)},mouseover:function(e){k(e)},mouseup:function(e){k(e),C()}}).clearstate),mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}),D=(g=ks(S),{keydown:function(e,n,t,r,o,u){var i=e.raw,c=i.which,l=!0===i.shiftKey;return rr(s,d.selectedSelector).fold((function(){return As(c)&&!l&&d.clearBeforeUpdate(s),fm(c)&&l?h(Rs,g,s,m,cm,r,n,d.selectRange):am(c)&&l?h(Rs,g,s,m,lm,r,n,d.selectRange):fm(c)?h(Ss,g,m,cm,r,n,xs):am(c)?h(Ss,g,m,lm,r,n,Ts):U.none}),(function(e){function n(n){return function(){return V(n,(function(n){return t=n.rows,r=n.cols,o=s,ur(e,t,r,(u=d).firstSelectedSelector,u.lastSelectedSelector).map((function(e){return u.clearBeforeUpdate(o),u.selectRange(o,e.boxes,e.start,e.finish),e.boxes}));var t,r,o,u})).fold((function(){return or(s,d.firstSelectedSelector,d.lastSelectedSelector).map((function(e){var n=fm(c)||u.isForward(c)?Pf.after:Pf.before;return g.setRelativeSelection(Pf.on(e.first,0),n(e.table)),d.clear(s),_s(U.none(),!0)}))}),(function(e){return U.some(_s(U.none(),!0))}))}}return fm(c)&&l?n([Is(1,0)]):am(c)&&l?n([Is(-1,0)]):u.isBackward(c)&&l?n([Is(0,-1),Is(-1,0)]):u.isForward(c)&&l?n([Is(0,1),Is(1,0)]):As(c)&&!l?A:U.none}))()},keyup:function(e,n,t,r,o){return rr(s,d.selectedSelector).fold((function(){var u,i,c,l,a,f=e.raw,g=f.which;return!0===f.shiftKey&&As(g)?(u=s,i=m,a=d.selectRange,le(c=n,l=r)&&t===o?U.none():In(c,"td,th",i).bind((function(e){return In(l,"td,th",i).bind((function(n){return Fs(u,i,e,n,a)}))}))):U.none()}),U.none)}}),O=(c=s=T,l=m=x,a=d=r,f=ks(S),function(e,n){a.clearBeforeUpdate(c),tr(e,n,l).each((function(e){var t=e.boxes.getOr([]);a.selectRange(c,t,e.start,e.finish),f.selectContents(n),f.collapseSelection()}))});function A(){return d.clear(s),U.none()}function k(e){y.on((function(n){w.clearBeforeUpdate(b),Ds(e.target,v).each((function(t){tr(n,t,v).each((function(n){var r,o,u,i=n.boxes.getOr([]);1===i.length?(r=i[0],o="false"===ta(r),u=Ln(Ou(e.target),r,le),o&&u&&(w.selectRange(b,i,r,r),p.selectContents(r))):1<i.length&&(w.selectRange(b,i,n.start,n.finish),p.selectContents(t))}))}))}))}function I(n,t){!0===n.raw.shiftKey&&(t.kill&&n.kill(),t.selection.each((function(n){var t=zf.relative(n.start,n.finish),r=bl(S,t);e.selection.setRng(r)})))}function B(e){return 0===e.button}e.on("TableSelectorChange",(function(e){return O(e.start,e.finish)}));var M,E,P=(M=zc(qe.fromDom(T)),E=zc(0),{touchEnd:function(e){var n,t,r=qe.fromDom(e.target);"td"!==Je(r)&&"th"!==Je(r)||(n=M.get(),t=E.get(),le(n,r)&&e.timeStamp-t<300&&(e.preventDefault(),O(r,r))),M.set(r),E.set(e.timeStamp)}});e.on("dragstart",(function(e){R.clearstate()})),e.on("mousedown",(function(e){B(e)&&Bs(e)&&R.mousedown(Zl(e))})),e.on("mouseover",(function(e){var n;(void 0===(n=e).buttons||dm.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&Bs(e)&&R.mouseover(Zl(e))})),e.on("mouseup",(function(e){B(e)&&Bs(e)&&R.mouseup(Zl(e))})),e.on("touchend",P.touchEnd),e.on("keyup",(function(n){var t,r,o,u=Zl(n);u.raw.shiftKey&&As(u.raw.which)&&(t=e.selection.getRng(),r=qe.fromDom(t.startContainer),o=qe.fromDom(t.endContainer),D.keyup(u,r,t.startOffset,o,t.endOffset).each((function(e){I(u,e)})))})),e.on("keydown",(function(t){var r=Zl(t);n().each((function(e){return e.hideBars()}));var o=e.selection.getRng(),u=qe.fromDom(o.startContainer),i=qe.fromDom(o.endContainer),c=Cr(sm,mm)(qe.fromDom(e.selection.getStart()));D.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(e){I(r,e)})),n().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var n=e.selection;er(rt,[qe.fromDom(n.getStart()),qe.fromDom(n.getEnd())]).fold((function(){return r.clear(T)}),u)}))})),{clear:r.clear}}function pm(e,n){function t(e){return g.forall((function(n){return!n[e]}))}function r(){return Ll(Jo(e),Ko(e)).bind((function(t){return Wn(rt(t),Ll(qe.fromDom(e.selection.getEnd()),Ko(e)).bind(rt),(function(e,r){return le(e,r)?p(t)?U.some({element:o=t,mergable:U.none(),unmergable:U.none(),selection:[o]}):U.some(Zo(n,e,t)):U.none();var o})).bind(c)}))}function o(e){return rt(e.element).map((function(n){var t=$t.fromTable(n),r=M(Ai(t,e).getOr([]),(function(e,n){return n.isLocked&&(e.onAny=!0,0===n.column?e.onFirst=!0:n.column+n.colspan>=t.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Bi(t,e).isSome(),unmergeable:Mi(t,e).isSome(),locked:r}}))}function u(){m.set(J(r)()),g=m.get().bind(o),A(d.get(),(function(e){return e()}))}function i(e){return e(),d.set(d.get().concat([e])),function(){d.set(I(d.get(),(function(n){return n!==e})))}}function l(e,n){return i((function(){return m.get().fold((function(){e.setDisabled(!0)}),(function(t){e.setDisabled(n(t))}))}))}function a(e,n,t){return i((function(){return m.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(r){e.setDisabled(n(r)),e.setActive(t(r))}))}))}function f(e){return g.exists((function(n){return n.locked[e]}))}function s(n,t){return function(r){return a(r,(function(e){return p(e.element)}),(function(){return e.queryCommandValue(n)===t}))}}var m=zc(U.none()),d=zc([]),g=U.none(),p=nn("caption"),b=s("mceTableRowType","header"),h=s("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(e){return l(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return l(e,(function(e){return p(e.element)}))},onSetupColumn:function(e){return function(n){return l(n,(function(n){return p(n.element)||f(e)}))}},onSetupPasteable:function(e){return function(n){return l(n,(function(n){return p(n.element)||e().isNone()}))}},onSetupPasteableColumn:function(e,n){return function(t){return l(t,(function(t){return p(t.element)||e().isNone()||f(n)}))}},onSetupMergeable:function(e){return l(e,(function(e){return t("mergeable")}))},onSetupUnmergeable:function(e){return l(e,(function(e){return t("unmergeable")}))},resetTargets:u,onSetupTableWithCaption:function(n){return a(n,y,(function(n){return rt(n.element,Ko(e)).exists((function(e){return An(e,"caption").isSome()}))}))},onSetupTableRowHeaders:b,onSetupTableColumnHeaders:h,targets:m.get}}Kr.add("table",(function(e){var n,t,r,o,c,l,f,s,m,d,g,p,b=(n=function(){return Uo(e)},t=function(){return _l(Jo(e),Ko(e))},r=zl.selectedSelector,{get:function(){return Vr(n(),r).fold((function(){return t().fold(Ur,$r)}),(function(e){return Gr(e)}))}}),h=pm(e,b),v=function(e){function n(e){return"TABLE"===e.nodeName}function t(n){return ui(e,n)}function r(){return(ei(e)?au:lu)()}var o,u,c=U.none(),l=U.none(),f=U.none();return e.on("init",(function(){var n,o,u,s,m,d,g,p,b,h,v,w,y,C,S=(o=ci,(n=e).inline?(d=Uo(n),qn(p=qe.fromTag("div"),{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Xt(Tn(qe.fromDom(document)),p),g=o,{parent:i(p),view:i(d),origin:i(no(0,0)),isResizable:g}):hl(qe.fromDom(n.getDoc()),o));f=U.some(S),m=e.getParam("object_resizing",!0),(a(m)?"table"===m:m)&&e.getParam("table_resize_bars",!0,"boolean")&&(u=r(),b=u,h=t,v=ro,w=uo,y=Nu(S),C=hu({beforeResize:bu(["table","type"]),afterResize:bu(["table","type"]),startDrag:bu([])}),y.events.adjustHeight.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"row");var t,r,o,u,i,c,l,a,f,s=v.delta(e.delta,n);t=n,r=s,o=e.row,u=v,a=O(Ao(l=$t.fromTable(t),t,u,wo,(function(e){return e.getOrThunk(Ht)})),(function(e,n){return o===n?Math.max(r+e,Ht()):e})),i=a,f=O($t.justCells(l),(function(e){var n=tu(e.row,e.row+e.rowspan,i);return{element:e.element,height:n,rowspan:e.rowspan}})),A((c=a,O(l.all,(function(e,n){return{element:e.element,height:c[n]}}))),(function(e){mo(e.element,e.height)})),A(f,(function(e){mo(e.element,e.height)})),mo(t,B(a,(function(e,n){return e+n}),0)),C.trigger.afterResize(n,"row")})),y.events.startAdjust.bind((function(e){C.trigger.startDrag()})),y.events.adjustWidth.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"col");var t=w.delta(e.delta,n),r=h(n);ou(n,t,e.column,b,r),C.trigger.afterResize(n,"col")})),(s={on:y.on,off:y.off,hideBars:y.hideBars,showBars:y.showBars,destroy:y.destroy,events:C.registry}).on(),s.events.startDrag.bind((function(n){c=U.some(e.selection.getRng())})),s.events.beforeResize.bind((function(n){var t,r=n.table.dom,o=e,u=Go(t=r),i=$o(r),c=Ca+n.type;o.fire("ObjectResizeStart",{target:t,width:u,height:i,origin:c})})),s.events.afterResize.bind((function(n){var t,r,o,u,i,l=n.table,a=l.dom;Yo(l),c.each((function(n){e.selection.setRng(n),e.focus()})),t=e,o=Go(r=a),u=$o(a),i=Ca+n.type,t.fire("ObjectResized",{target:r,width:o,height:u,origin:i}),e.undoManager.add()})),l=U.some(s))})),e.on("ObjectResizeStart",(function(t){var r,i,c,l,a=t.target;n(a)&&(r=qe.fromDom(a),A(e.dom.select(".mce-clonedresizable"),(function(n){e.dom.addClass(n,"mce-"+Zu(e)+"-columns")})),!wl(r)&&ba(e)?wa(r):!vl(r)&&Ju(e)&&va(r),yl(r)&&ke(t.origin,Ca)&&va(r),o=t.width,u=ha(e)?"":(l=(i=e).dom.getStyle(c=a,"width")||i.dom.getAttrib(c,"width"),U.from(l).filter(te).getOr("")))})),e.on("ObjectResized",(function(i){var c,l,a,f,s,m,d,g,p,b,h=i.target;n(h)&&(c=qe.fromDom(h),l=i.origin,ke(l,"corner-")&&(a=c,f=i.width,b=ne(l,"e"),""===u&&va(a),f!==o&&""!==u?(Vn(a,"width",u),s=r(),m=t(a),d=ei(e)||b?pu(a).columns-1:0,ou(a,f-o,d,s,m)):/^(\d+(\.\d+)?)%$/.test(u)&&Vn(a,"width",f*parseFloat(u.replace("%",""))/o+"%"),/^(\d+(\.\d+)?)px$/.test(u)&&(p=$t.fromTable(g=a),$t.hasColumns(p)||A(nt(g),(function(e){Vn(e,"width",Un(e,"width")),Wt(e,"width")})))),Yo(c),_u(e,c.dom,la))})),e.on("SwitchMode",(function(){l.each((function(n){e.mode.isReadOnly()?n.hideBars():n.showBars()}))})),{lazyResize:function(){return l},lazyWire:function(){return f.getOr(hl(qe.fromDom(e.getBody()),ci))},destroy:function(){l.each((function(e){e.destroy()})),f.each((function(n){var t=n;e.inline&&Yt(t.parent())}))}}}(e),w=gm(e,v.lazyResize,h),y=function(e,n,t){function r(e){return"table"===Je(Uo(e))}function o(t,r,o,u,c){return function(l,a,f){void 0===f&&(f=!1),Yo(l);var s=u(),m=qe.fromDom(e.getDoc()),d=Ho(o,m,i),g={sizing:ui(e,l),resize:(ni(e)?lu:au)(),section:function(n){switch(Qu(e)){case"section":return Oa();case"sectionCells":return Aa();case"cells":return ka();default:return function(e,n){switch(V($t.fromTable(e).all,(function(e){var n=mi(e);return"header"===n.type?U.from(n.subType):U.none()})).getOr("section")){case"section":return pi();case"sectionCells":return bi();case"cells":return hi()}}(n)}}(l)};return r(l)?t(s,l,a,d,g).bind((function(t){A(t.newRows,(function(n){zu(e,n.dom)})),A(t.newCells,(function(n){Lu(e,n.dom)}));var r,o=(r=l,t.cursor.fold((function(){return F(nt(r)).filter(Sn).map((function(t){n.clear(r);var o=e.dom.createRng();return o.selectNode(t.dom),e.selection.setRng(o),Mn(t,"data-mce-selected","1"),o}))}),(function(t){var o=Ta(xa,t),u=e.dom.createRng();return u.setStart(o.element.dom,o.offset),u.setEnd(o.element.dom,o.offset),e.selection.setRng(u),n.clear(r),U.some(u)})));return Sn(l)&&(Yo(l),f||_u(e,l.dom,c)),o.map((function(e){return{rng:e,effect:c}}))})):U.none()}}var i=ti(e),c=ni(e)?u:fi;return{deleteRow:o($a,(function(n){return!1===r(e)||1<pu(n).rows}),u,t,aa),deleteColumn:o(Ga,(function(n){return!1===r(e)||1<pu(n).columns}),u,t,aa),insertRowsBefore:o(Ha,C,u,t,aa),insertRowsAfter:o(Va,C,u,t,aa),insertColumnsBefore:o(qa,C,c,t,aa),insertColumnsAfter:o(Ua,C,c,t,aa),mergeCells:o(nf,C,u,t,aa),unmergeCells:o(tf,C,u,t,aa),pasteColsBefore:o(of,C,u,t,aa),pasteColsAfter:o(uf,C,u,t,aa),pasteRowsBefore:o(cf,C,u,t,aa),pasteRowsAfter:o(lf,C,u,t,aa),pasteCells:o(rf,C,u,t,fa),makeCellsHeader:o(Za,C,u,t,aa),unmakeCellsHeader:o(ef,C,u,t,aa),makeColumnsHeader:o(Ka,C,u,t,aa),unmakeColumnsHeader:o(Xa,C,u,t,aa),makeRowsHeader:o(Ya,C,u,t,aa),makeRowsBody:o(Ja,C,u,t,aa),makeRowsFooter:o(Qa,C,u,t,aa),getTableRowType:af,getTableCellType:yc,getTableColType:wc}}(e,w,v.lazyWire),S=(o=_c(),c=_c(),{getRows:o.get,setRows:function(e){e.fold(o.clear,o.set),c.clear()},clearRows:o.clear,getColumns:c.get,setColumns:function(e){e.fold(c.clear,c.set),o.clear()},clearColumns:c.clear});return cl(e,y,0,b,S),d=y,g=b,p=Ko(m=e),fe({mceTableRowType:function(){return T(d.getTableRowType)},mceTableCellType:function(){return T(d.getTableCellType)},mceTableColType:function(){return T(d.getTableColType)}},(function(e,n){return m.addQueryValueHandler(n,e)})),nu(e,b,y),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}function u(n){e.execCommand("mceInsertTable",!1,{rows:n.numRows,columns:n.numColumns})}var c={text:"Table properties",onSetup:t.onSetupTable,onAction:o("mceTableProps")},l={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)});var a={type:"nestedmenuitem",text:"Row",getSubmenuItems:i("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")});var f={type:"nestedmenuitem",text:"Column",getSubmenuItems:i("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});var s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:i("tablecellprops tablemergecells tablesplitcells")};!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:u}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",c),e.ui.registry.addMenuItem("deletetable",l),e.ui.registry.addNestedMenuItem("row",a),e.ui.registry.addNestedMenuItem("column",f),e.ui.registry.addNestedMenuItem("cell",s),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(i(""),(function(e){return"caption"===Je(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var m=wf(Yu(e));0!==m.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return vf(e,n,m,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)}))},onSetup:t.onSetupTable});var d=wf(Xu(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return vf(e,n,d,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)}))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return vf(e,n,mf,"tablecellverticalalign",jc(e,"vertical-align"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return vf(e,n,Fu(e),"tablecellborderwidth",jc(e,"border-width"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return vf(e,n,Hu(e),"tablecellborderstyle",jc(e,"border-style"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:o("mceTableToggleCaption"),onSetup:t.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return Hc(e,ri(e),"background-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return Hc(e,oi(e),"border-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:Vc(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:qc(e),onSetup:t.onSetupTableColumnHeaders})}(e,b,h,S),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}}),e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"});var u=wf(Yu(e));0!==u.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Fc(e,n,u,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)})),onSetup:t.onSetupTable});var i=wf(Xu(e));0!==i.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Fc(e,n,i,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)})),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Fc(e,n,mf,"tablecellverticalalign",jc(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Fc(e,n,Fu(e),"tablecellborderwidth",jc(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Fc(e,n,Hu(e),"tablecellborderstyle",jc(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:o("mceTableToggleCaption"),icon:"table-caption",onSetup:t.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(n){return n(Hc(e,ri(e),"background-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(n){return n(Hc(e,oi(e),"border-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:Vc(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:qc(e),onSetup:t.onSetupTableColumnHeaders})}(e,b,h,S),0<(s=(f=e).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&f.ui.registry.addContextToolbar("table",{predicate:function(e){return f.dom.is(e,"table")&&f.getBody().contains(e)},items:s,scope:"node",position:"node"}),e.on("PreInit",(function(){e.serializer.addTempAttr(zl.firstSelected),e.serializer.addTempAttr(zl.lastSelected),e.formatter.register(Af)})),e.getParam("table_tab_navigation",!0,"boolean")&&e.on("keydown",(function(n){var t,r,o,u,i=e,c=w;(t=n).keyCode===Ns.TAB&&(r=Uo(i),o=function(e){var n=Je(e);return le(e,r)||x(Ls,n)},u=i.selection.getRng(),et(qe.fromDom(t.shiftKey?u.startContainer:u.endContainer),o).each((function(e){t.preventDefault(),rt(e,o).each(c.clear),i.selection.collapse(t.shiftKey),(t.shiftKey?function(e,n,t){return zs(e,n,(o=Au,ll(r=t,void 0).fold((function(){return If.none()}),(function(e){return Bf(e.all,r,e.index,-1,o)}))));var r,o}:rs)(i,o,e).each((function(e){i.selection.setRng(e)}))})))})),e.on("remove",(function(){v.destroy()})),{insertTable:(l=e,function(e,n,t){var r=xc(l,n,e,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return l.undoManager.add(),r}),setClipboardRows:Dc(S.setRows),getClipboardRows:Rc(S.getRows),setClipboardCols:Dc(S.setColumns),getClipboardCols:Rc(S.getColumns),resizeHandler:v,selectionTargets:h};function T(e){return _l(Jo(m)).bind((function(n){return rt(n,p).map((function(t){var r=Zo(g,t,n);return e(t,r)}))})).getOr("")}}))}()})();